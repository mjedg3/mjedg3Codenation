//FILE GENERATED BY 'generate-resources-js.sh'!
const fs_rating_images = {
    blue: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfb2tfZmlsbGVkX3NtYWxsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imljb25zL3N0YXR1cy9pY19va19maWxsZWRfc21hbGwiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yMywxMiBDMjMsMTguMDc1NDczNyAxOC4wNzQ4OTQ3LDIzIDEyLDIzIEM1LjkyNTEwNTI2LDIzIDEsMTguMDc1NDczNyAxLDEyIEMxLDUuOTI0NTI2MzIgNS45MjUxMDUyNiwxIDEyLDEgQzE4LjA3NDg5NDcsMSAyMyw1LjkyNDUyNjMyIDIzLDEyIFoiIGlkPSJjaXJjbGUiIGZpbGw9IiMwMEJBRkYiPjwvcGF0aD4KICAgICAgICA8cGF0aCBkPSJNNi43MDI2MzIzNCwxMS40MTkyMDU0IEM2LjMwOTY1MjM2LDExLjAzMTE1MjQgNS42NzY0OTk5OCwxMS4wMzUxNDY0IDUuMjg4NDQ2OTIsMTEuNDI4MTI2NCBDNC45MDAzOTM4NiwxMS44MjExMDY0IDQuOTA0Mzg3OTIsMTIuNDU0MjU4OCA1LjI5NzM2NzkxLDEyLjg0MjMxMTkgTDkuMjE1NzM1MjUsMTYuNzExNTUzMyBDOS42MDU1NTU1MiwxNy4wOTY0ODYyIDEwLjIzMjUzMDEsMTcuMDk2MSAxMC42MjE4NzU4LDE2LjcxMDY4NzEgTDE4LjcwMzUwODUsOC43MTA2ODcwOCBDMTkuMDk2MDEwMSw4LjMyMjE1MDE1IDE5LjA5OTIyNDEsNy42ODg5OTMzMyAxOC43MTA2ODcxLDcuMjk2NDkxNzQgQzE4LjMyMjE1MDIsNi45MDM5OTAxNSAxNy42ODg5OTM0LDYuOTAwNzc2MTUgMTcuMjk2NDkxOCw3LjI4OTMxMzA4IEw5LjkxNzUwMTIxLDE0LjU5Mzc2ODQgTDYuNzAyNjMyMzQsMTEuNDE5MjA1NCBaIiBpZD0iU3Ryb2tlLTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+Cg==',
    bubble_background: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDEwcHgiIGhlaWdodD0iNjVweCIgdmlld0JveD0iMCAwIDgxMSAxMjgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUxLjMgKDU3NTQ0KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY19zYWZlX2Jyb3dzZXJfYnViYmxlPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGRlZnM+CiAgICAgICAgPHBhdGggZD0iTTMxNSwzODkgTDExMDIsMzg5IEMxMTA0LjIwOTE0LDM4OSAxMTA2LDM5MC43OTA4NjEgMTEwNiwzOTMgTDExMDYsNDg1IEMxMTA2LDQ4Ny4yMDkxMzkgMTEwNC4yMDkxNCw0ODkgMTEwMiw0ODkgTDM1Ny4zNzYxNDgsNDg5IEwzNDQuNjQ2NDA4LDUwMS43MDIxNzQgTDMzMS45MTY2NjgsNDg5IEwzMTUsNDg5IEMzMTIuNzkwODYxLDQ4OSAzMTEsNDg3LjIwOTEzOSAzMTEsNDg1IEwzMTEsMzkzIEMzMTEsMzkwLjc5MDg2MSAzMTIuNzkwODYxLDM4OSAzMTUsMzg5IFoiIGlkPSJwYXRoLTEiPjwvcGF0aD4KICAgICAgICA8ZmlsdGVyIHg9Ii0xLjclIiB5PSItOS4zJSIgd2lkdGg9IjEwMy40JSIgaGVpZ2h0PSIxMjQuMCUiIGZpbHRlclVuaXRzPSJvYmplY3RCb3VuZGluZ0JveCIgaWQ9ImZpbHRlci0yIj4KICAgICAgICAgICAgPGZlT2Zmc2V0IGR4PSIwIiBkeT0iMyIgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMSI+PC9mZU9mZnNldD4KICAgICAgICAgICAgPGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iNCIgaW49InNoYWRvd09mZnNldE91dGVyMSIgcmVzdWx0PSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlR2F1c3NpYW5CbHVyPgogICAgICAgICAgICA8ZmVDb21wb3NpdGUgaW49InNoYWRvd0JsdXJPdXRlcjEiIGluMj0iU291cmNlQWxwaGEiIG9wZXJhdG9yPSJvdXQiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUNvbXBvc2l0ZT4KICAgICAgICAgICAgPGZlQ29sb3JNYXRyaXggdmFsdWVzPSIwIDAgMCAwIDAuMjM1Mjk0MTE4ICAgMCAwIDAgMCAwLjIzNTI5NDExOCAgIDAgMCAwIDAgMC4yMzUyOTQxMTggIDAgMCAwIDAuNSAwIiB0eXBlPSJtYXRyaXgiIGluPSJzaGFkb3dCbHVyT3V0ZXIxIj48L2ZlQ29sb3JNYXRyaXg+CiAgICAgICAgPC9maWx0ZXI+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iU0FGRV9icm93c2luZ19wcm90ZWN0aW9uX2J1YmJsZV8wMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMwMy4wMDAwMDAsIC0zODQuMDAwMDAwKSIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGcgaWQ9ImljX3NhZmVfYnJvd3Nlcl9idWJibGUiPgogICAgICAgICAgICAgICAgPHVzZSBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIxIiBmaWx0ZXI9InVybCgjZmlsdGVyLTIpIiB4bGluazpocmVmPSIjcGF0aC0xIj48L3VzZT4KICAgICAgICAgICAgICAgIDxwYXRoIHN0cm9rZT0iI0JGQkZCRiIgc3Ryb2tlLXdpZHRoPSIxIiBkPSJNMzQ0LjY0NjQwOCw1MDAuOTk1ODMyIEwzNTcuMTY5MzU4LDQ4OC41IEwxMTAyLDQ4OC41IEMxMTAzLjkzMyw0ODguNSAxMTA1LjUsNDg2LjkzMjk5NyAxMTA1LjUsNDg1IEwxMTA1LjUsMzkzIEMxMTA1LjUsMzkxLjA2NzAwMyAxMTAzLjkzMywzODkuNSAxMTAyLDM4OS41IEwzMTUsMzg5LjUgQzMxMy4wNjcwMDMsMzg5LjUgMzExLjUsMzkxLjA2NzAwMyAzMTEuNSwzOTMgTDMxMS41LDQ4NSBDMzExLjUsNDg2LjkzMjk5NyAzMTMuMDY3MDAzLDQ4OC41IDMxNSw0ODguNSBMMzMyLjEyMzQ1Nyw0ODguNSBMMzQ0LjY0NjQwOCw1MDAuOTk1ODMyIFoiIHN0cm9rZS1saW5lam9pbj0ic3F1YXJlIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg==',
    denied: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfbG9nZ2Vkb3V0X2ZpbGxlZF9zbWFsbDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJpY29ucy9zdGF0dXMvaWNfbG9nZ2Vkb3V0X2ZpbGxlZF9zbWFsbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTIzLDEyIEMyMywxOC4wNzU0NzM3IDE4LjA3NDg5NDcsMjMgMTIsMjMgQzUuOTI1MTA1MjYsMjMgMSwxOC4wNzU0NzM3IDEsMTIgQzEsNS45MjQ1MjYzMiA1LjkyNTEwNTI2LDEgMTIsMSBDMTguMDc0ODk0NywxIDIzLDUuOTI0NTI2MzIgMjMsMTIgWiIgaWQ9ImNpcmNsZSIgZmlsbD0iI0ZCMzYzNiI+PC9wYXRoPgogICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIGZpbGw9IiNGRkZGRkYiIHg9IjYiIHk9IjExIiB3aWR0aD0iMTIiIGhlaWdodD0iMiIgcng9IjEiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+',
    error: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfZXJyb3JfZmlsbGVkX3NtYWxsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imljb25zL3N0YXR1cy9pY19lcnJvcl9maWxsZWRfc21hbGwiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yMywxMiBDMjMsMTguMDc1NDczNyAxOC4wNzQ4OTQ3LDIzIDEyLDIzIEM1LjkyNTEwNTI2LDIzIDEsMTguMDc1NDczNyAxLDEyIEMxLDUuOTI0NTI2MzIgNS45MjUxMDUyNiwxIDEyLDEgQzE4LjA3NDg5NDcsMSAyMyw1LjkyNDUyNjMyIDIzLDEyIFoiIGlkPSJjaXJjbGUiIGZpbGw9IiNGQjM2MzYiPjwvcGF0aD4KICAgICAgICA8cGF0aCBkPSJNMTMuMzYzOTYxLDExLjk0OTc0NzUgTDE4LjAyMDgxNTMsMTYuNjA2NjAxNyBDMTguNDExMzM5NiwxNi45OTcxMjYgMTguNDExMzM5NiwxNy42MzAyOTEgMTguMDIwODE1MywxOC4wMjA4MTUzIEMxNy42MzAyOTEsMTguNDExMzM5NiAxNi45OTcxMjYsMTguNDExMzM5NiAxNi42MDY2MDE3LDE4LjAyMDgxNTMgTDExLjk0OTc0NzUsMTMuMzYzOTYxIEw3LjcwNzEwNjc4LDE3LjYwNjYwMTcgQzcuMzE2NTgyNDksMTcuOTk3MTI2IDYuNjgzNDE3NTEsMTcuOTk3MTI2IDYuMjkyODkzMjIsMTcuNjA2NjAxNyBDNS45MDIzNjg5MywxNy4yMTYwNzc0IDUuOTAyMzY4OTMsMTYuNTgyOTEyNCA2LjI5Mjg5MzIyLDE2LjE5MjM4ODIgTDEwLjUzNTUzMzksMTEuOTQ5NzQ3NSBMNi43MDcxMDY3OCw4LjEyMTMyMDM0IEM2LjMxNjU4MjQ5LDcuNzMwNzk2MDUgNi4zMTY1ODI0OSw3LjA5NzYzMTA3IDYuNzA3MTA2NzgsNi43MDcxMDY3OCBDNy4wOTc2MzEwNyw2LjMxNjU4MjQ5IDcuNzMwNzk2MDUsNi4zMTY1ODI0OSA4LjEyMTMyMDM0LDYuNzA3MTA2NzggTDExLjk0OTc0NzUsMTAuNTM1NTMzOSBMMTYuMTkyMzg4Miw2LjI5Mjg5MzIyIEMxNi41ODI5MTI0LDUuOTAyMzY4OTMgMTcuMjE2MDc3NCw1LjkwMjM2ODkzIDE3LjYwNjYwMTcsNi4yOTI4OTMyMiBDMTcuOTk3MTI2LDYuNjgzNDE3NTEgMTcuOTk3MTI2LDcuMzE2NTgyNDkgMTcuNjA2NjAxNyw3LjcwNzEwNjc4IEwxMy4zNjM5NjEsMTEuOTQ5NzQ3NSBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+',
    ok: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfb2tfZmlsbGVkX3NtYWxsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Imljb25zL3N0YXR1cy9pY19va19maWxsZWRfc21hbGwiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yMywxMiBDMjMsMTguMDc1NDczNyAxOC4wNzQ4OTQ3LDIzIDEyLDIzIEM1LjkyNTEwNTI2LDIzIDEsMTguMDc1NDczNyAxLDEyIEMxLDUuOTI0NTI2MzIgNS45MjUxMDUyNiwxIDEyLDEgQzE4LjA3NDg5NDcsMSAyMyw1LjkyNDUyNjMyIDIzLDEyIFoiIGlkPSJjaXJjbGUiIGZpbGw9IiMwMEJFNUYiPjwvcGF0aD4KICAgICAgICA8cGF0aCBkPSJNNi43MDI2MzIzNCwxMS40MTkyMDU0IEM2LjMwOTY1MjM2LDExLjAzMTE1MjQgNS42NzY0OTk5OCwxMS4wMzUxNDY0IDUuMjg4NDQ2OTIsMTEuNDI4MTI2NCBDNC45MDAzOTM4NiwxMS44MjExMDY0IDQuOTA0Mzg3OTIsMTIuNDU0MjU4OCA1LjI5NzM2NzkxLDEyLjg0MjMxMTkgTDkuMjE1NzM1MjUsMTYuNzExNTUzMyBDOS42MDU1NTU1MiwxNy4wOTY0ODYyIDEwLjIzMjUzMDEsMTcuMDk2MSAxMC42MjE4NzU4LDE2LjcxMDY4NzEgTDE4LjcwMzUwODUsOC43MTA2ODcwOCBDMTkuMDk2MDEwMSw4LjMyMjE1MDE1IDE5LjA5OTIyNDEsNy42ODg5OTMzMyAxOC43MTA2ODcxLDcuMjk2NDkxNzQgQzE4LjMyMjE1MDIsNi45MDM5OTAxNSAxNy42ODg5OTM0LDYuOTAwNzc2MTUgMTcuMjk2NDkxOCw3LjI4OTMxMzA4IEw5LjkxNzUwMTIxLDE0LjU5Mzc2ODQgTDYuNzAyNjMyMzQsMTEuNDE5MjA1NCBaIiBpZD0iU3Ryb2tlLTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+',
    unknown: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfdW5rbm93bl9maWxsZWRfc21hbGw8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iaWNvbnMvc3RhdHVzL2ljX3Vua25vd25fZmlsbGVkX3NtYWxsIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMjMsMTIgQzIzLDE4LjA3NTQ3MzcgMTguMDc0ODk0NywyMyAxMiwyMyBDNS45MjUxMDUyNiwyMyAxLDE4LjA3NTQ3MzcgMSwxMiBDMSw1LjkyNDUyNjMyIDUuOTI1MTA1MjYsMSAxMiwxIEMxOC4wNzQ4OTQ3LDEgMjMsNS45MjQ1MjYzMiAyMywxMiBaIiBpZD0iY2lyY2xlIiBmaWxsPSIjOTk5OTk5Ij48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTEwLjkzNTI1MTgsMTMuNzQ1MzcwNCBDMTAuOTM1MjUxOCwxMy42ODYzMzY4IDEwLjk0MDM2NzEsMTMuNjI4NDk3OSAxMC45NTAxNzg3LDEzLjU3MjI3MjkgQzExLjA0OTc5MTMsMTIuMjE4NjQ5OCAxMS42NTMxMTE2LDExLjQ5ODQ2MzUgMTIuOTE0Mjk3NCwxMC42NjA2NzEyIEwxMi45NTIxNDM1LDEwLjYzNTUzNjQgQzEzLjgxOTIyNjYsMTAuMDU5NjcyIDE0LDkuODI2MDM2OTIgMTQsOS4wNzkyODI0MSBDMTQsNy43NTQxMDAzOSAxMy40MTMyMzI3LDcgMTIuMDQ3NjAwMyw3IEMxMC43NTQwNjk2LDcgMTAsNy41NTc4Njk1NiAxMCw4LjY3OTk3Njg1IEMxMCw5LjIzMjI2MTYgOS41NTIyODQ3NSw5LjY3OTk3Njg1IDksOS42Nzk5NzY4NSBDOC40NDc3MTUyNSw5LjY3OTk3Njg1IDgsOS4yMzIyNjE2IDgsOC42Nzk5NzY4NSBDOCw2LjMwMDMyNzAxIDkuNzU3NjQ1NjcsNSAxMi4wNDc2MDAzLDUgQzE0LjY0MzE1NjMsNSAxNiw2Ljc0Mzc4NTczIDE2LDkuMDc5MjgyNDEgQzE2LDEwLjY1MjAzMDggMTUuNDI2NjgyNCwxMS4zOTI5OTc5IDE0LjA1ODYyNzcsMTIuMzAxNTc3NCBMMTQuMDIwOTU0NCwxMi4zMjY1OTc0IEMxMy4xMzM2NzE2LDEyLjkxNjAwOTkgMTIuOTM1MjUxOCwxMy4xNzc2MjggMTIuOTM1MjUxOCwxNCBDMTIuOTM1MjUxOCwxNS4zMzMzMzMzIDEwLjkzNTI1MTgsMTUuMzMzMzMzMyAxMC45MzUyNTE4LDE0IEwxMC45MzUyNTE4LDEzLjc0NTM3MDQgWiBNMTMsMTguMDAxMDgzNCBDMTMsMTguNTUzNjI5NSAxMi41NTU3OTYzLDE5IDEyLjAwMDU0MTcsMTkgQzExLjQ0NjM3MDUsMTkgMTEsMTguNTUzNjI5NSAxMSwxOC4wMDEwODM0IEMxMSwxNy40NDc5OTU3IDExLjQ0NjM3MDUsMTcgMTIuMDAwNTQxNywxNyBDMTIuNTU1Nzk2MywxNyAxMywxNy40NDc5OTU3IDEzLDE4LjAwMTA4MzQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==',
    waiting: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNDhweCIgaGVpZ2h0PSI0OHB4IiB2aWV3Qm94PSIwIDAgNDggNDgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjIgKDY3MTQ1KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvIGljX2xvYWRpbmdfY2lyY3VsYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBkPSJNMSwyNCBMNSwyNCBDNSwzNC40OTM3NjEgMTMuNTA2MjM5LDQzIDI0LDQzIEMzNC40OTIzMTcyLDQzIDQzLDM0LjQ5MjkwNDggNDMsMjQgQzQzLDEzLjUwODUzOSAzNC40OTE0NjEsNSAyNCw1IEwyNCwxIEMzNi43MDA2LDEgNDcsMTEuMjk5NCA0NywyNCBDNDcsMzYuNzAyOSAzNi43MDA2LDQ3IDI0LDQ3IEMxMS4yOTcxLDQ3IDEsMzYuNzAyOSAxLDI0IFoiIGlkPSJwYXRoLTEiPjwvcGF0aD4KICAgIDwvZGVmcz4KICAgIDxnIGlkPSJpY29ucy9zdGF0dXMvLWljX2xvYWRpbmdfY2lyY3VsYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUtMzciIGZpbGwtcnVsZT0ibm9uemVybyIgeD0iMCIgeT0iMCIgd2lkdGg9IjQ4IiBoZWlnaHQ9IjQ4Ij48L3JlY3Q+CiAgICAgICAgPG1hc2sgaWQ9Im1hc2stMiIgZmlsbD0id2hpdGUiPgogICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgIDwvbWFzaz4KICAgICAgICA8dXNlIGlkPSJwcm9ncmVzcyIgZmlsbD0iIzAwQkFGRiIgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICA8L2c+Cjwvc3ZnPg==',
    warning: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU2LjMgKDgxNzE2KSAtIGh0dHBzOi8vc2tldGNoLmNvbSAtLT4KICAgIDx0aXRsZT5pY29ucy9zdGF0dXMvaWNfd2FybmluZ19maWxsZWRfc21hbGw8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iaWNvbnMvc3RhdHVzL2ljX3dhcm5pbmdfZmlsbGVkX3NtYWxsIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMjMsMTIgQzIzLDE4LjA3NTQ3MzcgMTguMDc0ODk0NywyMyAxMiwyMyBDNS45MjUxMDUyNiwyMyAxLDE4LjA3NTQ3MzcgMSwxMiBDMSw1LjkyNDUyNjMyIDUuOTI1MTA1MjYsMSAxMiwxIEMxOC4wNzQ4OTQ3LDEgMjMsNS45MjQ1MjYzMiAyMywxMiBaIiBpZD0iY2lyY2xlIiBmaWxsPSIjRkZBQjAwIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTEzLDE5LjAwMjY2NjcgQzEzLDE5LjU1MTMzMzMgMTIuNTUzMDM1NCwyMCAxMiwyMCBDMTEuNDQ4Mjk4OSwyMCAxMSwxOS41NTEzMzMzIDExLDE5LjAwMjY2NjcgQzExLDE4LjQ1IDExLjQ0ODI5ODksMTggMTIsMTggQzEyLjU1MzAzNTQsMTggMTMsMTguNDUgMTMsMTkuMDAyNjY2NyBaIE0xMywxNSBDMTMsMTUuNTUyMjg0NyAxMi41NTIyODQ3LDE2IDEyLDE2IEMxMS40NDc3MTUzLDE2IDExLDE1LjU1MjI4NDcgMTEsMTUgTDExLDUgQzExLDQuNDQ3NzE1MjUgMTEuNDQ3NzE1Myw0IDEyLDQgQzEyLjU1MjI4NDcsNCAxMyw0LjQ0NzcxNTI1IDEzLDUgTDEzLDE1IFoiIGlkPSJleGNsYW1hdGlvbiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgPC9nPgo8L3N2Zz4=',
};
const fs_category_mappings = {
    'adult_content': {
        title: 'string-category-adult_content',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMy45LDE2bDMuMi00YzAuMi0wLjIsMC4xLTAuNS0wLjEtMC43Yy0wLjItMC4yLTAuNS0wLjEtMC43LDAuMWwtMy4xLDMuOGwtMy4xLTMuOA0KCWMtMC4xLTAuMi0wLjQtMC4yLTAuNi0wLjFjLTAuMi0wLjEtMC40LDAtMC42LDAuMUwxNiwxNS4ybC0zLjEtMy44Yy0wLjEtMC4yLTAuNC0wLjItMC42LTAuMWMtMC4yLTAuMS0wLjQsMC0wLjYsMC4xbC0zLjEsMy44DQoJbC0zLjEtMy44Yy0wLjItMC4yLTAuNS0wLjMtMC43LTAuMWMtMC4yLDAuMi0wLjIsMC41LTAuMSwwLjdsMy4yLDRsLTMuMiw0Yy0wLjIsMC4yLTAuMSwwLjUsMC4xLDAuN2MwLjEsMC4xLDAuMiwwLjEsMC4zLDAuMQ0KCWMwLjEsMCwwLjMtMC4xLDAuNC0wLjJsMy4xLTMuOGwzLjEsMy44YzAuMSwwLjEsMC4yLDAuMiwwLjQsMC4yYzAuMSwwLDAuMSwwLDAuMiwwYzAuMSwwLDAuMSwwLDAuMiwwYzAuMSwwLDAuMy0wLjEsMC40LTAuMg0KCWwzLjEtMy44bDMuMSwzLjhjMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4xLDAsMC4xLDAsMC4yLDBjMC4xLDAsMC4xLDAsMC4yLDBjMC4xLDAsMC4zLTAuMSwwLjQtMC4ybDMuMS0zLjhsMy4xLDMuOA0KCWMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMmMwLjEsMCwwLjIsMCwwLjMtMC4xYzAuMi0wLjIsMC4yLTAuNSwwLjEtMC43TDIzLjksMTZ6IE0xMi40LDE5LjdsLTMtMy43bDMtMy43bDMsMy43TDEyLjQsMTkuN3oNCgkgTTE5LjYsMTkuN2wtMy0zLjdsMy0zLjdsMywzLjdMMTkuNiwxOS43eiIvPg0KPC9zdmc+DQo=',
    },
    'alcohol': {
        title: 'string-category-alcohol',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMCwyNC41aC04Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVWMTJjMC0wLjMsMC4yLTAuNSwwLjUtMC41aDIuNVY3YzAtMC4zLDAuMi0wLjUsMC41LTAuNWgyDQoJCWMwLjMsMCwwLjUsMC4yLDAuNSwwLjV2NC41SDIwYzAuMywwLDAuNSwwLjIsMC41LDAuNXYxMkMyMC41LDI0LjMsMjAuMywyNC41LDIwLDI0LjV6IE0xMi41LDIzLjVoN3YtMTFIMTdjLTAuMywwLTAuNS0wLjItMC41LTAuNQ0KCQlWNy41aC0xVjEyYzAsMC4zLTAuMiwwLjUtMC41LDAuNWgtMi41VjIzLjV6Ii8+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'anonymizers': {
        title: 'string-category-anonymizers',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPGc+DQoJCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjQuNCwyMy40QzI0LjQsMjMuNCwyNC40LDIzLjQsMjQuNCwyMy40Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjYtMC4zLTIuMi0wLjctMw0KCQkJYy0wLjctMC40LTItMS4xLTIuOC0xLjVDMTkuOCwxOSwxOC41LDIwLDE2LDIwcy0zLjgtMS00LjQtMS42Yy0wLjgsMC4zLTIuMiwxLjEtMi44LDEuNWMtMC40LDAuOC0wLjcsMi4zLTAuNywzDQoJCQljMCwwLjMtMC4yLDAuNS0wLjUsMC41YzAsMCwwLDAsMCwwYy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjgsMC40LTIuNywwLjktMy42YzAtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDIuNS0xLjQsMy41LTEuNw0KCQkJYzAuMi0wLjEsMC40LDAsMC42LDAuMmMwLDAuMSwxLjEsMS41LDMuOCwxLjVjMi43LDAsMy43LTEuNCwzLjgtMS41YzAuMS0wLjIsMC40LTAuMywwLjYtMC4yYzEsMC4zLDMuNCwxLjcsMy41LDEuNw0KCQkJYzAuMSwwLDAuMSwwLjEsMC4yLDAuMmMwLjUsMC45LDAuOSwyLjgsMC45LDMuNkMyNC45LDIzLjIsMjQuNywyMy40LDI0LjQsMjMuNHoiLz4NCgk8L2c+DQo8L2c+DQo8Zz4NCgk8Zz4NCgkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNi4xLDE0LjFjLTAuMywwLTAuNS0wLjItMC41LTAuNWMwLTEuNCwwLjgtMiwxLjUtMi41YzAuNi0wLjQsMS0wLjgsMS0xLjZjMC0wLjktMC41LTItMi0yDQoJCQljLTEsMC0yLDAuOC0yLDJjMCwwLjMtMC4yLDAuNS0wLjUsMC41cy0wLjUtMC4yLTAuNS0wLjVjMC0xLjksMS42LTMsMy0zYzIuMSwwLDMsMS42LDMsM2MwLDEuNC0wLjgsMi0xLjQsMi40DQoJCQljLTAuNiwwLjQtMS4xLDAuOC0xLjEsMS43QzE2LjYsMTMuOSwxNi40LDE0LjEsMTYuMSwxNC4xeiIvPg0KCTwvZz4NCgk8Zz4NCgkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNywxNS45YzAsMC41LTAuNCwwLjgtMC44LDAuOGMtMC41LDAtMC44LTAuNC0wLjgtMC44YzAtMC41LDAuNC0wLjgsMC44LTAuOA0KCQkJQzE2LjYsMTUuMSwxNywxNS41LDE3LDE1Ljl6Ii8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+DQo=',
    },
    'dating': {
        title: 'string-category-dating',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZGQUIwMDsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xOS42LDEwLjRjMi4xLDAsMy44LDEuNywzLjgsMy44YzAsMS40LTAuOSwyLjUtMS4zLDIuOWMtMC4xLDAuMS0wLjMsMC4zLTAuNCwwLjRMMTYsMjMuMWwtNS42LTUuNg0KCWMtMC4xLTAuMS0wLjMtMC4zLTAuNC0wLjVjLTAuOS0wLjktMS4zLTEuOC0xLjMtMi45YzAtMi4xLDEuNy0zLjgsMy44LTMuOGMxLjEsMCwyLjEsMC41LDIuOCwxLjNjMC4yLDAuMiwwLjUsMC4zLDAuOCwwLjMNCglzMC42LTAuMSwwLjgtMC4zQzE3LjUsMTAuOCwxOC41LDEwLjQsMTkuNiwxMC40IE0xOS42LDkuNGMtMS40LDAtMi43LDAuNi0zLjYsMS42aDBjLTAuOS0xLTIuMi0xLjYtMy42LTEuNmMtMi43LDAtNC44LDIuMS00LjgsNC44DQoJYzAsMS40LDAuNywyLjYsMS42LDMuNmMwLjMsMC4zLDAuNCwwLjQsMC40LDAuNGMwLDAtMC40LTAuNC0wLjQtMC40bDYuOCw2LjhsNi44LTYuOGMwLDAtMC40LDAuNC0wLjQsMC40YzAsMCwwLjEtMC4xLDAuNC0wLjQNCgljMC45LTAuOSwxLjYtMi4yLDEuNi0zLjZDMjQuNCwxMS41LDIyLjMsOS40LDE5LjYsOS40TDE5LjYsOS40eiIvPg0KPC9zdmc+DQo=',
    },
    'distrurbing': {
        title: 'string-category-distrurbing',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxnPg0KCQk8Y2lyY2xlIHN0eWxlPSJmaWxsOiNGQjM2MzY7IiBjeD0iMTYiIGN5PSIxNiIgcj0iMTQiLz4NCgk8L2c+DQo8L2c+DQo8Zz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTExLjQsMjYuNGMtMC4xLDAtMC4yLDAtMC4zLTAuMWMtMC4yLTAuMS0wLjMtMC40LTAuMS0wLjZsNC40LTguNWwtMy44LTEuOQ0KCQljLTAuMS0wLjEtMC4yLTAuMi0wLjMtMC4zYzAtMC4xLDAtMC4zLDAuMS0wLjRsNi4zLTguN2MwLjEtMC4yLDAuNC0wLjMsMC42LTAuMmw0LjEsMmMwLjEsMC4xLDAuMiwwLjIsMC4zLDAuMw0KCQljMCwwLjEsMCwwLjMtMC4xLDAuNGwtNC4xLDUuMWwzLjgsMmMwLjEsMC4xLDAuMiwwLjIsMC4zLDAuNGMwLDAuMiwwLDAuMy0wLjIsMC40bC0xMC41LDkuOUMxMS42LDI2LjQsMTEuNSwyNi40LDExLjQsMjYuNHoNCgkJIE0xMi41LDE0LjZsMy43LDEuOGMwLjEsMC4xLDAuMiwwLjIsMC4zLDAuM2MwLDAuMSwwLDAuMywwLDAuNGwtMy4zLDYuNGw3LjktNy40bC0zLjctMS45Yy0wLjEtMC4xLTAuMi0wLjItMC4zLTAuM3MwLTAuMywwLjEtMC40DQoJCWw0LjEtNS4xbC0zLjEtMS41TDEyLjUsMTQuNnoiLz4NCjwvZz4NCjwvc3ZnPg0K',
    },
    'drugs': {
        title: 'string-category-drugs',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMy44LDExLjZjLTAuMSwwLTAuMywwLTAuNC0wLjFsLTIuOS0yLjljLTAuMi0wLjItMC4yLTAuNSwwLTAuN3MwLjUtMC4yLDAuNywwbDIuOSwyLjkNCgkJYzAuMiwwLjIsMC4yLDAuNSwwLDAuN0MyNCwxMS41LDIzLjksMTEuNiwyMy44LDExLjZ6Ii8+DQo8L2c+DQo8Zz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDsiIGQ9Ik0xNCwxNS40Ii8+DQo8L2c+DQo8Zz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDoxMDsiIGQ9Ik0xNi42LDE4Ii8+DQo8L2c+DQo8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTIyLjEsMTIuOGwtMi45LTIuOWMtMC4yLTAuMi0wLjUtMC4yLTAuNywwTDExLjQsMTdjLTAuMiwwLjItMC4yLDAuNSwwLDAuN2wxLjEsMS4xbC00LDMuOQ0KCWMtMC4yLDAuMi0wLjIsMC41LDAsMC43YzAuMSwwLjEsMC4yLDAuMSwwLjQsMC4xczAuMywwLDAuNC0wLjFsNC0zLjlsMS4xLDEuMWMwLjEsMC4xLDAuMiwwLjEsMC40LDAuMXMwLjMtMC4xLDAuNC0wLjFsNy4xLTcuMQ0KCWMwLjEtMC4xLDAuMS0wLjIsMC4xLTAuNFMyMi4yLDEyLjksMjIuMSwxMi44eiBNMTQuNiwxOS42bC0yLjItMi4ybDYuNC02LjRsMi4yLDIuMkwxNC42LDE5LjZ6Ii8+DQo8L3N2Zz4NCg==',
    },
    'filtering_category_vod': {
        title: 'string-category-filtering_category_vod',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4xLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQoJLnN0MHtmaWxsOiNGRkFCMDA7fQ0KCS5zdDF7ZmlsbDojRkZGRkZGO30NCjwvc3R5bGU+DQo8Zz4NCgk8Zz4NCgkJPGNpcmNsZSBjbGFzcz0ic3QwIiBjeD0iMTYiIGN5PSIxNiIgcj0iMTIuNiIvPg0KCTwvZz4NCjwvZz4NCjxwYXRoIGNsYXNzPSJzdDEiIGQ9Ik0xMi41LDIzYy0wLjEsMC0wLjIsMC0wLjItMC4xYy0wLjItMC4xLTAuMy0wLjMtMC4zLTAuNFY5LjRDMTIsOS4yLDEyLjEsOSwxMi4zLDljMC4yLTAuMSwwLjQtMC4xLDAuNSwwDQoJbDEwLjQsNi41YzAuMSwwLjEsMC4yLDAuMywwLjIsMC40cy0wLjEsMC4zLTAuMiwwLjRsLTEwLjQsNi42QzEyLjcsMjIuOSwxMi42LDIzLDEyLjUsMjN6IE0xMywxMC4zdjExLjJsOC45LTUuN0wxMywxMC4zeiIvPg0KPC9zdmc+DQo=',
    },
    'gambling': {
        title: 'string-category-gambling',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxnPg0KCQk8Y2lyY2xlIHN0eWxlPSJmaWxsOiNGQjM2MzY7IiBjeD0iMTYiIGN5PSIxNiIgcj0iMTQiLz4NCgk8L2c+DQo8L2c+DQo8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTI2LjEsMTYuOGwtNC40LTguM2MwLTAuMS0wLjEtMC4xLTAuMi0wLjJjMCwwLDAsMC0wLjEsMGMwLDAtMC4xLDAtMC4xLDBjMCwwLTAuMSwwLTAuMSwwDQoJYzAsMCwwLDAsMCwwbC04LjQsMWMtMC4xLDAtMC4yLDAuMS0wLjMsMC4xbC01LjcsNS45YzAsMCwwLDAsMCwwLjFjMCwwLDAsMC0wLjEsMC4xYzAsMCwwLDAuMSwwLDAuMWMwLDAsMCwwLjEsMCwwLjENCgljMCwwLjEsMCwwLjEsMCwwLjJjMCwwLDAsMCwwLDAuMWMwLDAsMCwwLDAsMGMwLDAsMCwwLDAsMGw0LjQsNy44YzAuMSwwLjIsMC4zLDAuMywwLjQsMC4zYzAsMCwwLDAsMCwwbDguNy0wLjMNCgljMC4xLDAsMC4yLDAsMC4yLTAuMWMwLDAsMCwwLDAsMGMwLDAsMCwwLDAuMS0wLjFjMCwwLDAsMCwwLjEsMGw1LjQtNkMyNi4yLDE3LjIsMjYuMiwxNi45LDI2LjEsMTYuOHogTTEzLjEsMTAuMWw2LjgtMC44bC00LjgsNC44DQoJbC02LjYsMC44TDEzLjEsMTAuMXogTTgsMTUuOWw3LjEtMC45bDQuNCw3LjVsLTcuNiwwLjJMOCwxNS45eiBNMjAuNCwyMi4yTDE2LDE0LjZsNS4yLTUuMmwzLjksNy40TDIwLjQsMjIuMnoiLz4NCjxnPg0KCTxnPg0KCQk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTExLjMsMThjLTAuMiwwLTAuMy0wLjEtMC40LTAuMmMtMC4yLTAuMi0wLjEtMC42LDAuMS0wLjdjMC4yLTAuMiwwLjUtMC4xLDAuNywwLjFsMCwwDQoJCQljMC4yLDAuMiwwLjEsMC41LTAuMSwwLjdDMTEuNSwxOCwxMS40LDE4LDExLjMsMTh6Ii8+DQoJPC9nPg0KCTxnPg0KCQk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTEzLjgsMTIuNmMtMC4yLDAtMC4zLTAuMS0wLjQtMC4yYy0wLjEtMC4xLTAuMS0wLjMtMC4xLTAuNWMwLTAuMSwwLjEtMC4zLDAuNC0wLjQNCgkJCWMwLjEtMC4xLDAuMi0wLjEsMC4zLTAuMWMwLjIsMCwwLjQsMCwwLjUsMC4xczAuMiwwLjMsMC4xLDAuNWMwLDAuMS0wLjEsMC4yLTAuMiwwLjRDMTQuMSwxMi41LDE0LDEyLjYsMTMuOCwxMi42DQoJCQlDMTMuOSwxMi42LDEzLjgsMTIuNiwxMy44LDEyLjZ6Ii8+DQoJPC9nPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMTEuMywxOGMtMC4yLDAtMC4zLTAuMS0wLjQtMC4yYy0wLjItMC4yLTAuMS0wLjYsMC4xLTAuN2MwLjItMC4yLDAuNS0wLjEsMC43LDAuMWwwLDANCgkJYzAuMiwwLjIsMC4xLDAuNS0wLjEsMC43QzExLjUsMTgsMTEuNCwxOCwxMS4zLDE4eiIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMTUuNCwyMC43Yy0wLjEsMC0wLjIsMC0wLjMtMC4xbDAsMGMtMC4yLTAuMi0wLjMtMC41LTAuMS0wLjdjMC4yLTAuMiwwLjUtMC4zLDAuNy0wLjENCgkJczAuMywwLjUsMC4xLDAuN0MxNS43LDIwLjYsMTUuNSwyMC43LDE1LjQsMjAuN3oiLz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTIwLjcsMTkuMUMyMC42LDE5LjEsMjAuNiwxOS4xLDIwLjcsMTkuMWMtMC40LTAuMS0wLjUtMC4zLTAuNS0wLjZsMC0wLjFjMC0wLjMsMC4zLTAuNSwwLjYtMC40DQoJCWMwLjMsMCwwLjUsMC4zLDAuNCwwLjZDMjEuMSwxOC45LDIwLjksMTkuMSwyMC43LDE5LjF6Ii8+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMC43LDEzLjVDMjAuNiwxMy41LDIwLjYsMTMuNSwyMC43LDEzLjVjLTAuNC0wLjEtMC41LTAuMy0wLjUtMC42bDAtMC4xYzAuMS0wLjMsMC4zLTAuNCwwLjYtMC40DQoJCWMwLjMsMC4xLDAuNSwwLjMsMC40LDAuNkMyMS4xLDEzLjMsMjAuOSwxMy41LDIwLjcsMTMuNXoiLz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTIwLjcsMTYuM0MyMC42LDE2LjMsMjAuNiwxNi4zLDIwLjcsMTYuM2MtMC40LTAuMS0wLjUtMC4zLTAuNS0wLjZsMC0wLjFjMC4xLTAuMywwLjMtMC41LDAuNi0wLjQNCgkJYzAuMywwLjEsMC41LDAuMywwLjQsMC42QzIxLjEsMTYuMSwyMC45LDE2LjMsMjAuNywxNi4zeiIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMTMuOCwxMi42Yy0wLjIsMC0wLjMtMC4xLTAuNC0wLjJjLTAuMS0wLjEtMC4xLTAuMy0wLjEtMC41YzAtMC4xLDAuMS0wLjMsMC40LTAuNA0KCQljMC4xLTAuMSwwLjItMC4xLDAuMy0wLjFjMC4yLDAsMC40LDAsMC41LDAuMWMwLjEsMC4xLDAuMiwwLjMsMC4xLDAuNWMwLDAuMS0wLjEsMC4yLTAuMiwwLjRDMTQuMSwxMi41LDE0LDEyLjYsMTMuOCwxMi42DQoJCUMxMy45LDEyLjYsMTMuOCwxMi42LDEzLjgsMTIuNnoiLz4NCjwvZz4NCjwvc3ZnPg0K',
    },
    'hate': {
        title: 'string-category-hate',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZGQUIwMDsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yNC4zLDExbC0yLjEtMS45QzIyLjEsOS4xLDIxLjksOSwyMS44LDloLTYuM2MtMC4xLDAtMC4yLDAtMC4zLDAuMWwtMi4yLDEuOGgtMS44di0wLjQNCgljMC0wLjMtMC4yLTAuNS0wLjUtMC41SDhjLTAuMywwLTAuNSwwLjItMC41LDAuNVYxOGMwLDAuMywwLjIsMC41LDAuNSwwLjVoMi44YzAuMywwLDAuNS0wLjIsMC41LTAuNXYtMC4yYzMuNSwxLjUsNS44LDguMiw1LjgsOC4zDQoJYzAuMSwwLjIsMC4zLDAuMywwLjUsMC4zaDJjMC4zLDAsMC41LTAuMiwwLjUtMC41bDAtMS43YzAtMC4xLDAtMC4xLDAtMC4ybC0wLjQtMS4xbDAtMi4zbDMuMiwwYzAuMSwwLDAuMiwwLDAuMy0wLjFsMS0wLjcNCgljMC4xLTAuMSwwLjItMC4yLDAuMi0wLjRsMC03LjlDMjQuNSwxMS4zLDI0LjQsMTEuMSwyNC4zLDExeiBNMTAuMywxNy41SDguNVYxMWgxLjh2MC40djUuNlYxNy41eiBNMjMuNSwxOS4xbC0wLjcsMC41bC0zLjYsMA0KCWMtMC4zLDAtMC41LDAuMi0wLjUsMC41bDAsMi45YzAsMC4xLDAsMC4xLDAsMC4ybDAuNCwxLjFsMCwxLjJoLTEuMWMtMC41LTEuNS0yLjktNy41LTYuNi04Ljd2LTQuOGgyYzAuMSwwLDAuMiwwLDAuMy0wLjFsMi4yLTEuOA0KCWg1LjlsMS44LDEuNkwyMy41LDE5LjF6Ii8+DQo8L3N2Zz4NCg==',
    },
    'illegal': {
        title: 'string-category-illegal',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2UtbGluZWNhcDpyb3VuZDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6MTA7IiBkPSJNMTksNy4zIi8+DQo8L2c+DQo8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTIyLjYsMjAuMWMtMC43LTAuMy0yLjMtMS0zLjEtMS41YzAuMS0wLjIsMC4yLTAuMywwLjItMC4zYzAuMS0wLjIsMC4xLTAuNSwwLTAuNg0KCUMxOSwxNywxOC45LDE2LjgsMTguOSwxNmMwLjQtMC43LDAuNy0xLjMsMC45LTEuOHYtMC4xYzAuOS0yLDAuNS0zLjQsMC4zLTQuM0wyMCw5LjZjLTAuNC0xLjMtMS4yLTIuOC00LjEtMi44cy0zLjcsMS41LTQuMSwyLjgNCglsLTAuMSwwLjJjLTAuMiwwLjgtMC42LDIuMiwwLjMsNC4zYzAuMywwLjcsMC44LDEuNiwwLjksMS45YzAsMC44LDAsMS0wLjgsMS43Yy0wLjIsMC4yLTAuMiwwLjQtMC4xLDAuNmMwLDAsMC4xLDAuMSwwLjIsMC4yDQoJQzExLjQsMTksOS43LDE5LjcsOC45LDIwYy0xLjEsMC42LTEuOCwxLjgtMS44LDMuMWMwLDAuMywwLjIsMC41LDAuNSwwLjVzMC41LTAuMiwwLjUtMC41YzAtMSwwLjUtMS44LDEuMi0yLjINCgljMC4zLTAuMSwyLjYtMS4xLDMuNi0xLjdjMC4xLDAuMSwwLjIsMC4yLDAuMywwLjJjMC44LDAuNSwyLjMsMC42LDIuNCwwLjZsMCwwbDAsMGMwLjIsMCwxLjctMC4xLDIuNC0wLjZjMC4xLTAuMSwwLjItMC4xLDAuMy0wLjINCgljMSwwLjYsMy4yLDEuNiwzLjUsMS43YzAuOCwwLjUsMS4zLDEuMywxLjMsMi4zYzAsMC4zLDAuMiwwLjUsMC41LDAuNXMwLjUtMC4yLDAuNS0wLjVDMjQuNCwyMS45LDIzLjcsMjAuOCwyMi42LDIwLjF6IE0xMy4yLDEyLjINCgljMC0wLjQsMC40LTAuOCwxLTAuOHMxLDAuMywxLDAuOHMtMC40LDAuOC0xLDAuOFMxMy4yLDEyLjUsMTMuMiwxMi4yeiBNMTUuOSwxNi43Yy0wLjgsMC0xLjUtMC40LTEuNS0xczAuNy0xLDEuNS0xDQoJYzAuOCwwLDEuNSwwLjQsMS41LDFDMTcuNCwxNi4zLDE2LjcsMTYuNywxNS45LDE2Ljd6IE0xNy42LDEyLjljLTAuNywwLTEtMC4zLTEtMC44czAuNC0wLjgsMS0wLjhzMSwwLjMsMSwwLjhTMTguMywxMi45LDE3LjYsMTIuOQ0KCXoiLz4NCjwvc3ZnPg0K',
    },
    'illegal_downloads': {
        title: 'string-category-illegal_downloads',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEwOyIgZD0iTTE5LDcuMyIvPg0KPC9nPg0KPGc+DQoJPGNpcmNsZSBzdHlsZT0iZmlsbDojRkIzNjM2OyIgY3g9IjE2IiBjeT0iMTYiIHI9IjE0Ii8+DQo8L2c+DQo8Zz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTE1LjYsMjAuMWMwLjEsMC4xLDAuMiwwLjEsMC40LDAuMXMwLjMsMCwwLjQtMC4xbDQuMS00LjFjMC4yLTAuMiwwLjItMC41LDAtMC43cy0wLjUtMC4yLTAuNywwDQoJCWwtMy4yLDMuMlY3LjVDMTYuNSw3LjIsMTYuMyw3LDE2LDdzLTAuNSwwLjItMC41LDAuNXYxMS4xbC0zLjItMy4yYy0wLjItMC4yLTAuNS0wLjItMC43LDBzLTAuMiwwLjUsMCwwLjdMMTUuNiwyMC4xeiIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjMsMjJIOWMtMC4zLDAtMC41LDAuMi0wLjUsMC41UzguNywyMyw5LDIzaDE0YzAuMywwLDAuNS0wLjIsMC41LTAuNVMyMy4zLDIyLDIzLDIyeiIvPg0KPC9nPg0KPC9zdmc+DQo=',
    },
    'shopping': {
        title: 'string-category-shopping',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZGQUIwMDsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMC42LDE5LjVjLTAuMi0xLjYtMC45LTMuMS00LjUtMy45Yy0zLjItMC43LTMuMS0yLjgtMy4xLTIuOWMwLjEtMS45LDEuNS0yLjcsMi44LTIuOA0KCWMxLjktMC4yLDMuMywxLjQsMy40LDEuNWMwLjIsMC4yLDAuNSwwLjIsMC43LDAuMWMwLjItMC4yLDAuMi0wLjUsMC4xLTAuN2MtMC4yLTAuMi0xLjUtMS43LTMuNS0xLjlWNi41QzE2LjUsNi4yLDE2LjMsNiwxNiw2DQoJcy0wLjUsMC4yLTAuNSwwLjV2Mi40Yy0yLDAuMi0zLjQsMS43LTMuNSwzLjdjMCwwLjEtMC4yLDMuMSwzLjksNGMzLjQsMC44LDMuNiwyLjIsMy43LDMuMWMwLjEsMC42LTAuMiwxLjMtMC43LDEuOQ0KCWMtMC43LDAuOC0xLjYsMS4yLTIuNiwxLjNjMCwwLDAsMC0wLjEsMGMtMS43LDAtMy4zLTEuMy0zLjgtMS45Yy0wLjItMC4yLTAuNS0wLjMtMC43LTAuMWMtMC4yLDAuMi0wLjMsMC41LTAuMSwwLjcNCgljMC42LDAuOSwyLjIsMi4xLDQsMi4zVjI2YzAsMC4zLDAuMiwwLjUsMC41LDAuNXMwLjUtMC4yLDAuNS0wLjV2LTIuMmMxLjItMC4xLDIuMy0wLjYsMy4xLTEuNkMyMC4zLDIxLjQsMjAuNywyMC40LDIwLjYsMTkuNXoiLz4NCjwvc3ZnPg0K',
    },
    'social_networks': {
        title: 'string-category-social_networks',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPGc+DQoJCTxnPg0KCQkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNiwxNi43Yy0wLjksMC0xLjctMC40LTIuMy0xYy0wLjctMC44LTEuNS0yLjMtMS41LTRjMC0yLjEsMS00LjQsMy45LTQuNGMyLjQsMCwzLjgsMS42LDMuOCw0LjQNCgkJCQljMCwxLjQtMC42LDMtMS41LDRDMTcuNywxNi4zLDE2LjksMTYuNywxNiwxNi43eiBNMTYsOC4zYy0yLjUsMC0yLjksMi4xLTIuOSwzLjRjMCwxLjIsMC41LDIuNSwxLjMsMy4zYzAuOSwwLjksMi4zLDAuOSwzLjIsMA0KCQkJCWMwLjctMC44LDEuMy0yLjEsMS4zLTMuM0MxOC45LDkuNCwxNy45LDguMywxNiw4LjN6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPGc+DQoJCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjQuNCwyMy40QzI0LjQsMjMuNCwyNC40LDIzLjQsMjQuNCwyMy40Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjYtMC4zLTIuMi0wLjctMw0KCQkJYy0wLjctMC40LTItMS4xLTIuOC0xLjVDMTkuOCwxOSwxOC41LDIwLDE2LDIwcy0zLjgtMS00LjQtMS42Yy0wLjgsMC4zLTIuMiwxLjEtMi44LDEuNWMtMC40LDAuOC0wLjcsMi4zLTAuNywzDQoJCQljMCwwLjMtMC4yLDAuNS0wLjUsMC41YzAsMCwwLDAsMCwwYy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjgsMC40LTIuNywwLjktMy42YzAtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDIuNS0xLjQsMy41LTEuNw0KCQkJYzAuMi0wLjEsMC40LDAsMC42LDAuMmMwLDAuMSwxLjEsMS41LDMuOCwxLjVjMi43LDAsMy43LTEuNCwzLjgtMS41YzAuMS0wLjIsMC40LTAuMywwLjYtMC4yYzEsMC4zLDMuNCwxLjcsMy41LDEuNw0KCQkJYzAuMSwwLDAuMSwwLjEsMC4yLDAuMmMwLjUsMC45LDAuOSwyLjgsMC45LDMuNkMyNC45LDIzLjIsMjQuNywyMy40LDI0LjQsMjMuNHoiLz4NCgk8L2c+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'unknown': {
        title: 'string-category-unknown',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNS41LDE5LjdjLTAuMywwLTAuNS0wLjItMC41LTAuNVYxOWMwLDAsMC0wLjEsMC0wLjFjMC4xLTIuMiwxLjQtMywyLjUtMy44YzEuMS0wLjcsMi0xLjMsMi0zDQoJCWMwLTEuOC0wLjYtMy45LTMuNS0zLjljLTEuOSwwLTMuOSwwLjktMy45LDMuNGMwLDAuMy0wLjIsMC41LTAuNSwwLjVzLTAuNS0wLjItMC41LTAuNWMwLTMuMywyLjYtNC40LDQuOS00LjQNCgkJYzIuOSwwLDQuNSwxLjgsNC41LDQuOWMwLDIuMy0xLjMsMy4xLTIuNCwzLjlDMTcsMTYuNywxNiwxNy4zLDE2LDE5LjJDMTYsMTkuNSwxNS44LDE5LjcsMTUuNSwxOS43eiIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNy4xLDI0LjNjMCwwLjgtMC42LDEuNC0xLjQsMS40Yy0wLjgsMC0xLjQtMC42LTEuNC0xLjRjMC0wLjgsMC42LTEuNCwxLjQtMS40DQoJCUMxNi40LDIyLjgsMTcuMSwyMy41LDE3LjEsMjQuM3oiLz4NCjwvZz4NCjwvc3ZnPg0K',
    },
    'violence': {
        title: 'string-category-violence',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEwOyIgZD0iTTE5LDcuMyIvPg0KPC9nPg0KPGc+DQoJPGNpcmNsZSBzdHlsZT0iZmlsbDojRkZBQjAwOyIgY3g9IjE2IiBjeT0iMTYiIHI9IjE0Ii8+DQo8L2c+DQo8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTI1LjEsOS42bC0yLjktMS4xbDAuMS0wLjhjMC0wLjItMC4xLTAuNS0wLjQtMC42bC0zLjQtMWwwLTAuMWMwLTAuMS0wLjEtMC4zLTAuMi0wLjQNCgljLTAuMS0wLjEtMC4zLTAuMS0wLjQtMC4xTDEzLjksNmMtMC4zLDAtMC41LDAuMy0wLjQsMC41bDAsMEw5LjksNy44QzkuNyw3LjksOS42LDguMSw5LjYsOC4zbDAuMSwzLjFsLTAuNCwwLjENCgljLTAuMiwwLTAuNCwwLjItMC40LDAuNGMtMC4xLDAuNC0wLjUsNC4xLDAsNS40YzAuMiwwLjYsMS40LDEuNywxLjksMi4xbC0wLjgsNS41YzAsMC4zLDAuMSwwLjUsMC40LDAuNmMwLDAsMCwwLDAuMSwwDQoJYzAuMiwwLDAuNS0wLjIsMC41LTAuNGwwLjgtNS44YzAtMC4yLDAtMC4zLTAuMi0wLjVjLTAuOC0wLjYtMS43LTEuNS0xLjgtMS45Yy0wLjMtMC43LTAuMS0zLDAtNC41bDUuMy0wLjhjMC4xLDAuNiwwLjIsMS41LDAsMg0KCWMtMC4xLDAuMy0xLjIsMC45LTIuMSwxLjNjLTAuMywwLjEtMC40LDAuNC0wLjMsMC42YzAuMSwwLjMsMC40LDAuNCwwLjYsMC4zYzAuNC0wLjEsMS4zLTAuNSwyLTFjMC4yLDAuMSwwLjcsMC4yLDEuMiwwLjINCgljMC40LDAsMC45LTAuMSwxLjMtMC4zYzAsMCwwLjEsMCwwLjEsMGMwLjIsMC4xLDEuMywwLjUsMS44LDAuNWMwLjUsMCwxLTAuNCwxLjMtMC43YzAuMywwLjMsMC43LDAuNywxLDAuOGMwLjEsMCwwLjIsMCwwLjIsMC4xDQoJYy0wLjEsMC45LTAuMiwyLjUtMC40LDMuMWMtMC4yLDAuNC0xLjEsMS41LTEuNywyLjFjLTAuMSwwLjEtMC4yLDAuMy0wLjEsMC40bDAuOCw1LjRjMCwwLjIsMC4zLDAuNCwwLjUsMC40YzAsMCwwLDAsMC4xLDANCgljMC4zLDAsMC41LTAuMywwLjQtMC42TDIwLjgsMjFjMC40LTAuNSwxLjQtMS42LDEuNy0yLjJjMC4zLTAuOCwwLjUtMi42LDAuNS0zLjRjMC41LTAuMSwwLjgtMC4zLDAuOS0wLjVjMCwwLDAuMS0wLjEsMC4xLTAuMg0KCWwxLjMtNC40QzI1LjUsMTAsMjUuMyw5LjcsMjUuMSw5LjZ6IE0xMC42LDguNmwyLjktMS4xbDAuMSwzLjNsLTIuOSwwLjVMMTAuNiw4LjZ6IE0xNiwxMy45YzAuNC0xLjEsMC0yLjgsMC0zDQoJYy0wLjEtMC4yLTAuMy0wLjQtMC42LTAuNGwtMC44LDAuMWwtMC4xLTMuOGwzLTAuM2wtMC4xLDdjMCwwLTAuMSwwLTAuMSwwLjFDMTcsMTQsMTYuNCwxNCwxNiwxMy45eiBNMjAuNCwxMy41DQoJYy0wLjMsMC4zLTAuNywwLjYtMC45LDAuNmMtMC4yLDAtMC43LTAuMS0xLjEtMC4zbDAuMS02LjZMMjEuMiw4TDIwLjQsMTMuNXogTTIzLjIsMTQuMmMtMC4xLDAuMS0wLjQsMC4zLTEsMC4xDQoJYy0wLjEtMC4xLTAuNC0wLjQtMC43LTAuN2wwLjYtNGwyLjMsMC44TDIzLjIsMTQuMnoiLz4NCjwvc3ZnPg0K',
    },
    'weapons': {
        title: 'string-category-weapons',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZGQUIwMDsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yNiwxNS41aC0xLjVjLTAuMy00LjMtMy43LTcuNy04LThWNmMwLTAuMy0wLjItMC41LTAuNS0wLjVTMTUuNSw1LjcsMTUuNSw2djEuNQ0KCWMtNC4zLDAuMy03LjcsMy43LTgsOEg2Yy0wLjMsMC0wLjUsMC4yLTAuNSwwLjVzMC4yLDAuNSwwLjUsMC41aDEuNWMwLjMsNC4zLDMuNyw3LjcsOCw4VjI2YzAsMC4zLDAuMiwwLjUsMC41LDAuNXMwLjUtMC4yLDAuNS0wLjUNCgl2LTEuNWM0LjMtMC4zLDcuNy0zLjcsOC04SDI2YzAuMywwLDAuNS0wLjIsMC41LTAuNVMyNi4zLDE1LjUsMjYsMTUuNXogTTIzLjUsMTUuNWgtN3YtN0MyMC4yLDguOCwyMy4yLDExLjgsMjMuNSwxNS41eiBNMTUuNSw4LjUNCgl2N2gtN0M4LjgsMTEuOCwxMS44LDguOCwxNS41LDguNXogTTguNSwxNi41aDd2N0MxMS44LDIzLjIsOC44LDIwLjIsOC41LDE2LjV6IE0xNi41LDIzLjV2LTdoN0MyMy4yLDIwLjIsMjAuMiwyMy4yLDE2LjUsMjMuNXoiLz4NCjwvc3ZnPg0K',
    },
    'adult': {
        title: 'string-category-adult',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMy45LDE2bDMuMi00YzAuMi0wLjIsMC4xLTAuNS0wLjEtMC43Yy0wLjItMC4yLTAuNS0wLjEtMC43LDAuMWwtMy4xLDMuOGwtMy4xLTMuOA0KCWMtMC4xLTAuMi0wLjQtMC4yLTAuNi0wLjFjLTAuMi0wLjEtMC40LDAtMC42LDAuMUwxNiwxNS4ybC0zLjEtMy44Yy0wLjEtMC4yLTAuNC0wLjItMC42LTAuMWMtMC4yLTAuMS0wLjQsMC0wLjYsMC4xbC0zLjEsMy44DQoJbC0zLjEtMy44Yy0wLjItMC4yLTAuNS0wLjMtMC43LTAuMWMtMC4yLDAuMi0wLjIsMC41LTAuMSwwLjdsMy4yLDRsLTMuMiw0Yy0wLjIsMC4yLTAuMSwwLjUsMC4xLDAuN2MwLjEsMC4xLDAuMiwwLjEsMC4zLDAuMQ0KCWMwLjEsMCwwLjMtMC4xLDAuNC0wLjJsMy4xLTMuOGwzLjEsMy44YzAuMSwwLjEsMC4yLDAuMiwwLjQsMC4yYzAuMSwwLDAuMSwwLDAuMiwwYzAuMSwwLDAuMSwwLDAuMiwwYzAuMSwwLDAuMy0wLjEsMC40LTAuMg0KCWwzLjEtMy44bDMuMSwzLjhjMC4xLDAuMSwwLjIsMC4yLDAuNCwwLjJjMC4xLDAsMC4xLDAsMC4yLDBjMC4xLDAsMC4xLDAsMC4yLDBjMC4xLDAsMC4zLTAuMSwwLjQtMC4ybDMuMS0zLjhsMy4xLDMuOA0KCWMwLjEsMC4xLDAuMiwwLjIsMC40LDAuMmMwLjEsMCwwLjIsMCwwLjMtMC4xYzAuMi0wLjIsMC4yLTAuNSwwLjEtMC43TDIzLjksMTZ6IE0xMi40LDE5LjdsLTMtMy43bDMtMy43bDMsMy43TDEyLjQsMTkuN3oNCgkgTTE5LjYsMTkuN2wtMy0zLjdsMy0zLjdsMywzLjdMMTkuNiwxOS43eiIvPg0KPC9zdmc+DQo=',
    },
    'alcohol and tobacco': {
        title: 'string-category-alcohol-tobacco',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6I0ZCMzYzNjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0yMCwyNC41aC04Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVWMTJjMC0wLjMsMC4yLTAuNSwwLjUtMC41aDIuNVY3YzAtMC4zLDAuMi0wLjUsMC41LTAuNWgyDQoJCWMwLjMsMCwwLjUsMC4yLDAuNSwwLjV2NC41SDIwYzAuMywwLDAuNSwwLjIsMC41LDAuNXYxMkMyMC41LDI0LjMsMjAuMywyNC41LDIwLDI0LjV6IE0xMi41LDIzLjVoN3YtMTFIMTdjLTAuMywwLTAuNS0wLjItMC41LTAuNQ0KCQlWNy41aC0xVjEyYzAsMC4zLTAuMiwwLjUtMC41LDAuNWgtMi41VjIzLjV6Ii8+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'social networking': {
        title: 'string-category-social-networking',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPGc+DQoJCTxnPg0KCQkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNiwxNi43Yy0wLjksMC0xLjctMC40LTIuMy0xYy0wLjctMC44LTEuNS0yLjMtMS41LTRjMC0yLjEsMS00LjQsMy45LTQuNGMyLjQsMCwzLjgsMS42LDMuOCw0LjQNCgkJCQljMCwxLjQtMC42LDMtMS41LDRDMTcuNywxNi4zLDE2LjksMTYuNywxNiwxNi43eiBNMTYsOC4zYy0yLjUsMC0yLjksMi4xLTIuOSwzLjRjMCwxLjIsMC41LDIuNSwxLjMsMy4zYzAuOSwwLjksMi4zLDAuOSwzLjIsMA0KCQkJCWMwLjctMC44LDEuMy0yLjEsMS4zLTMuM0MxOC45LDkuNCwxNy45LDguMywxNiw4LjN6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPGc+DQoJCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjQuNCwyMy40QzI0LjQsMjMuNCwyNC40LDIzLjQsMjQuNCwyMy40Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjYtMC4zLTIuMi0wLjctMw0KCQkJYy0wLjctMC40LTItMS4xLTIuOC0xLjVDMTkuOCwxOSwxOC41LDIwLDE2LDIwcy0zLjgtMS00LjQtMS42Yy0wLjgsMC4zLTIuMiwxLjEtMi44LDEuNWMtMC40LDAuOC0wLjcsMi4zLTAuNywzDQoJCQljMCwwLjMtMC4yLDAuNS0wLjUsMC41YzAsMCwwLDAsMCwwYy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjgsMC40LTIuNywwLjktMy42YzAtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDIuNS0xLjQsMy41LTEuNw0KCQkJYzAuMi0wLjEsMC40LDAsMC42LDAuMmMwLDAuMSwxLjEsMS41LDMuOCwxLjVjMi43LDAsMy43LTEuNCwzLjgtMS41YzAuMS0wLjIsMC40LTAuMywwLjYtMC4yYzEsMC4zLDMuNCwxLjcsMy41LDEuNw0KCQkJYzAuMSwwLDAuMSwwLjEsMC4yLDAuMmMwLjUsMC45LDAuOSwyLjgsMC45LDMuNkMyNC45LDIzLjIsMjQuNywyMy40LDI0LjQsMjMuNHoiLz4NCgk8L2c+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'forum': {
        title: 'string-category-social-networking',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPGc+DQoJCTxnPg0KCQkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNiwxNi43Yy0wLjksMC0xLjctMC40LTIuMy0xYy0wLjctMC44LTEuNS0yLjMtMS41LTRjMC0yLjEsMS00LjQsMy45LTQuNGMyLjQsMCwzLjgsMS42LDMuOCw0LjQNCgkJCQljMCwxLjQtMC42LDMtMS41LDRDMTcuNywxNi4zLDE2LjksMTYuNywxNiwxNi43eiBNMTYsOC4zYy0yLjUsMC0yLjksMi4xLTIuOSwzLjRjMCwxLjIsMC41LDIuNSwxLjMsMy4zYzAuOSwwLjksMi4zLDAuOSwzLjIsMA0KCQkJCWMwLjctMC44LDEuMy0yLjEsMS4zLTMuM0MxOC45LDkuNCwxNy45LDguMywxNiw4LjN6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPGc+DQoJCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjQuNCwyMy40QzI0LjQsMjMuNCwyNC40LDIzLjQsMjQuNCwyMy40Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjYtMC4zLTIuMi0wLjctMw0KCQkJYy0wLjctMC40LTItMS4xLTIuOC0xLjVDMTkuOCwxOSwxOC41LDIwLDE2LDIwcy0zLjgtMS00LjQtMS42Yy0wLjgsMC4zLTIuMiwxLjEtMi44LDEuNWMtMC40LDAuOC0wLjcsMi4zLTAuNywzDQoJCQljMCwwLjMtMC4yLDAuNS0wLjUsMC41YzAsMCwwLDAsMCwwYy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjgsMC40LTIuNywwLjktMy42YzAtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDIuNS0xLjQsMy41LTEuNw0KCQkJYzAuMi0wLjEsMC40LDAsMC42LDAuMmMwLDAuMSwxLjEsMS41LDMuOCwxLjVjMi43LDAsMy43LTEuNCwzLjgtMS41YzAuMS0wLjIsMC40LTAuMywwLjYtMC4yYzEsMC4zLDMuNCwxLjcsMy41LDEuNw0KCQkJYzAuMSwwLDAuMSwwLjEsMC4yLDAuMmMwLjUsMC45LDAuOSwyLjgsMC45LDMuNkMyNC45LDIzLjIsMjQuNywyMy40LDI0LjQsMjMuNHoiLz4NCgk8L2c+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'blogs': {
        title: 'string-category-social-networking',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxjaXJjbGUgc3R5bGU9ImZpbGw6IzAwQkFGRjsiIGN4PSIxNiIgY3k9IjE2IiByPSIxNCIvPg0KPC9nPg0KPGc+DQoJPGc+DQoJCTxnPg0KCQkJPHBhdGggc3R5bGU9ImZpbGw6I0ZGRkZGRjsiIGQ9Ik0xNiwxNi43Yy0wLjksMC0xLjctMC40LTIuMy0xYy0wLjctMC44LTEuNS0yLjMtMS41LTRjMC0yLjEsMS00LjQsMy45LTQuNGMyLjQsMCwzLjgsMS42LDMuOCw0LjQNCgkJCQljMCwxLjQtMC42LDMtMS41LDRDMTcuNywxNi4zLDE2LjksMTYuNywxNiwxNi43eiBNMTYsOC4zYy0yLjUsMC0yLjksMi4xLTIuOSwzLjRjMCwxLjIsMC41LDIuNSwxLjMsMy4zYzAuOSwwLjksMi4zLDAuOSwzLjIsMA0KCQkJCWMwLjctMC44LDEuMy0yLjEsMS4zLTMuM0MxOC45LDkuNCwxNy45LDguMywxNiw4LjN6Ii8+DQoJCTwvZz4NCgk8L2c+DQoJPGc+DQoJCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjQuNCwyMy40QzI0LjQsMjMuNCwyNC40LDIzLjQsMjQuNCwyMy40Yy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjYtMC4zLTIuMi0wLjctMw0KCQkJYy0wLjctMC40LTItMS4xLTIuOC0xLjVDMTkuOCwxOSwxOC41LDIwLDE2LDIwcy0zLjgtMS00LjQtMS42Yy0wLjgsMC4zLTIuMiwxLjEtMi44LDEuNWMtMC40LDAuOC0wLjcsMi4zLTAuNywzDQoJCQljMCwwLjMtMC4yLDAuNS0wLjUsMC41YzAsMCwwLDAsMCwwYy0wLjMsMC0wLjUtMC4yLTAuNS0wLjVjMC0wLjgsMC40LTIuNywwLjktMy42YzAtMC4xLDAuMS0wLjEsMC4yLTAuMmMwLjEtMC4xLDIuNS0xLjQsMy41LTEuNw0KCQkJYzAuMi0wLjEsMC40LDAsMC42LDAuMmMwLDAuMSwxLjEsMS41LDMuOCwxLjVjMi43LDAsMy43LTEuNCwzLjgtMS41YzAuMS0wLjIsMC40LTAuMywwLjYtMC4yYzEsMC4zLDMuNCwxLjcsMy41LDEuNw0KCQkJYzAuMSwwLDAuMSwwLjEsMC4yLDAuMmMwLjUsMC45LDAuOSwyLjgsMC45LDMuNkMyNC45LDIzLjIsMjQuNywyMy40LDI0LjQsMjMuNHoiLz4NCgk8L2c+DQo8L2c+DQo8L3N2Zz4NCg==',
    },
    'warez': {
        title: 'string-category-illegal-download',
        icon: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOC4xLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjAgMCAzMiAzMiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzIgMzI7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxwYXRoIHN0eWxlPSJmaWxsOm5vbmU7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLWxpbmVjYXA6cm91bmQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjEwOyIgZD0iTTE5LDcuMyIvPg0KPC9nPg0KPGc+DQoJPGNpcmNsZSBzdHlsZT0iZmlsbDojRkIzNjM2OyIgY3g9IjE2IiBjeT0iMTYiIHI9IjE0Ii8+DQo8L2c+DQo8Zz4NCgk8cGF0aCBzdHlsZT0iZmlsbDojRkZGRkZGOyIgZD0iTTE1LjYsMjAuMWMwLjEsMC4xLDAuMiwwLjEsMC40LDAuMXMwLjMsMCwwLjQtMC4xbDQuMS00LjFjMC4yLTAuMiwwLjItMC41LDAtMC43cy0wLjUtMC4yLTAuNywwDQoJCWwtMy4yLDMuMlY3LjVDMTYuNSw3LjIsMTYuMyw3LDE2LDdzLTAuNSwwLjItMC41LDAuNXYxMS4xbC0zLjItMy4yYy0wLjItMC4yLTAuNS0wLjItMC43LDBzLTAuMiwwLjUsMCwwLjdMMTUuNiwyMC4xeiIvPg0KCTxwYXRoIHN0eWxlPSJmaWxsOiNGRkZGRkY7IiBkPSJNMjMsMjJIOWMtMC4zLDAtMC41LDAuMi0wLjUsMC41UzguNywyMyw5LDIzaDE0YzAuMywwLDAuNS0wLjIsMC41LTAuNVMyMy4zLDIyLDIzLDIyeiIvPg0KPC9nPg0KPC9zdmc+DQo=',
    },
};
/**
 * Handler for SafariExtensionHandler obj-c communication.
 * Nothing in this injeted script is persistent or able to access
 * external services outside the websites security settings.
 * SafariExtensionHandler is required for such things.
 */
class MessageHandler {
    constructor(configure)
    {
        this.http_proxy_request_map = new Map();
        this.config_update_queue = [];

        const handle_config_update = (config) => {
            if (configure(config)) {
                this.config_update_queue.forEach((request) => {
                    request();
                });

                this.config_update_queue = [];
            }
        };

        safari.self.addEventListener('message', (event) => {
            if (event.name === 'fs-config') {
                handle_config_update(event.message);
            } else if (event.name === 'fs-http-proxy') {
                if (this.http_proxy_request_map.size !== 0) {
                    const request = this.http_proxy_request_map.get(event.message.url);
                    if (request) {
                        request(event.message.response);
                        this.http_proxy_request_map.delete(event.message.url);
                    } else {
                        console.trace('key not found in map', event.message.url, this.http_proxy_request_map);
                    }
                }
            } else {
                console.error('unknown event', event.name);
            }
        });
    }

    update_configuration(callback)
    {
        if (callback) {
            this.config_update_queue.push(callback);
        }

        safari.extension.dispatchMessage('fs-config');
    }

    proxy_request(url, method, body, callback)
    {
        this.http_proxy_request_map.set(url, callback);
        safari.extension.dispatchMessage('fs-http-proxy', {
            url,
            method,
            body: body ? body : null,
        });
    }

    static whitelist_url(url, cookie)
    {
        console.debug('whitelisting url', url, 'with cookie', cookie);
        if (url && cookie) {
            safari.extension.dispatchMessage('fs-blockpage-button-action', {
                url,
                cookie,
            });
        } else {
            console.error('url or cookie missing');
        }
    }

    static log(level, log)
    {
        //note, log forwarding to safari objective-c through IPC dispatchMessage is extremely CPU intensive and can hang Safari on busy websites
        safari.extension.dispatchMessage('fs-log', {
            level,
            log,
        });
    }
}
const search_engine = {
    resolve(url) {
        if (search_engine.current) {
            return search_engine.current;
        }

        search_engine.current = null;

        if (search_engine.engines) {
            for (const [name, engine] of Object.entries(search_engine.engines)) {
                if (engine.regex.test(url)) {
                    search_engine[name] = engine;
                    search_engine.current = engine;
                    break;
                }
            }

            search_engine.engines = null;
        }

        return search_engine.current;
    },
    parse_redirection(url) {
        if (!search_engine.yahoo) {
            return null;
        } else if (url.match(search_engine.yahoo.alt_redirection_regex)) {
            url = 'http:' + url;
        } else if (!url.match(search_engine.yahoo.redirection_regex)) {
            return null;
        }

        const link_query_params = url.replace(search_engine.yahoo.path_regex, '').split('/');
        const query_params = {};
        let redirection_url = null;

        link_query_params.forEach((pairstr) => {
            const keyvalue = pairstr.split('=');
            keyvalue[0] = unescape(keyvalue[0]);
            if (keyvalue.length > 1) {
                keyvalue[1] = unescape(keyvalue[1]);
            }
            query_params[keyvalue[0]] = keyvalue[1];
        });

        if (query_params.RU) {
            redirection_url = query_params.RU;
        }

        console.trace('Parsed Yahoo redirection parameters ', query_params, ' with redirect to ', redirection_url);
        return redirection_url;
    },
    engines: {
        google: {
            regex: /^https*:\/\/www\.google\.[^/].*/,
            operate(callback) {
                callback(document.querySelectorAll('div.rc .r a:not(.fl)'));
                callback(document.querySelectorAll('div span h3.r a')); //subcategories
            },
            search_path_regex: /^(?:search|images|custom|cse|s)$/,
            safe_search_query: 'safe=vss',
        },
        bing: {
            regex: /^https*:\/\/www\.bing\.com.*/,
            operate(callback) {
                callback(document.querySelectorAll('#b_results li.b_algo h2 a'));
                callback(document.querySelectorAll('#b_results li.b_algo div ul li h3 a')); //subcategories
            },
            search_path_regex: /^(?:search|images|videos)$/,
            safe_search_query: 'adlt=strict',
        },
        yahoo: {
            regex: /^https*:\/\/.*\.yahoo\.com.*/,
            redirection_regex: /^https*:\/\/r\.search\.yahoo\.com.*/,
            alt_redirection_regex: /^\/\/r\.search\.yahoo\.com.*/,
            path_regex: /^https*:\/\/[^/]+\//,
            operate(callback) {
                callback(document.querySelectorAll('#web ol li div div h3 a'));
            },
            search_path_regex: /^search$/,
            safe_search_query: 'vm=r',
        },
        yahoo_jp: {
            regex: /^https*:\/\/.*\.yahoo\.co\.jp.*/,
            operate(callback) {
                callback(document.querySelectorAll('div.hd h3 a'));
            },
            search_path_regex: /^search$/,
            safe_search_query: 'vm=r',
        },
        duckduckgo: {
            regex: /^https*:\/\/duckduckgo\.com.*/,
            operate(callback) {
                function try_find() {
                    callback(document.querySelectorAll('#links div div h2 a:not(.result__check)'));
                }

                try_find();

                search_engine.mutation_observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        console.debug('mutation observer event', mutation);
                    });

                    try_find();
                });

                try {
                    search_engine.mutation_observer.observe(document.querySelector('div#links.results'), {
                        childList: true,
                    });
                } catch (error) {
                    console.debug(error);
                }
            },
            search_path_regex: '',
            safe_search_query: 'kp=1',
        },
    },
};
function hostname_for_url(url) {
    url = new URL(url);
    console.debug('hostname_for_url ' + url + ' is ' + url.hostname);
    return url.hostname;
}

function is_whitelisted_in(url, fsbp_whitelist) {
    if (!url) {
        return false;
    }

    console.debug('is_whitelisted: checking url ' + url);
    for (const i in fsbp_whitelist) {
        if (fsbp_whitelist[i] === url) {
            console.log('Whitelisted URL (exact match)');
            return true;
        }
        if (fsbp_whitelist[i].indexOf('://') > -1) {
            // full URL in whitelist
            console.debug('Comparing whitelisted URL ' + fsbp_whitelist[i] + ' against base of ' + url);
            const fs_baseURL_re = /([^:]+:\/\/[^/]+).*/;
            const baseURL_whitelist = fsbp_whitelist[i].replace(fs_baseURL_re, '$1');
            const baseURL_queried = url.replace(fs_baseURL_re, '$1');
            if (baseURL_whitelist === baseURL_queried) {
                console.log('Whitelisted URL (base URL match)', url, fsbp_whitelist[i]);
                return true;
            }
        } else {
            // domain in whitelist
            console.debug('Comparing whitelisted domain ' + fsbp_whitelist[i] + ' against ' + hostname_for_url(url));
            const host_name = hostname_for_url(url);
            if (host_name === fsbp_whitelist[i]) {
                console.log('Exact whitelist match');
                return true;
            }
            const parts = host_name.split('.').reverse();
            let str = '';
            for (let part_index = 0; part_index < parts.length; part_index++) {
                if (str === '') {
                    str = parts[part_index];
                } else {
                    str = parts[part_index] + '.' + str;
                }

                console.debug('Comparing ' + str + ' with ' + fsbp_whitelist[i] + ' (part_index=' + part_index + ')');
                if (str === fsbp_whitelist[i]) {
                    console.debug('Reverse domain match (' + str + '=' + fsbp_whitelist[i] + ')');
                    return true;
                }
            }
        }
    }

    return false;
}
/**
 * Return true if an object with the supplied cats should be blocked
 * according to current settings. To block a category, add it to global array
 * "blocked_cats" (e.g. blocked_cats = ["adserving", "fso_adserving"];
 */
function is_unsafe(cats) {
    const unsafe = cats && cats.safe && cats.safe[0] < -79;
    console.debug(`${arguments.callee.name}: ${unsafe}`);
    return unsafe;
}

function banking_protection_enabled() {
    const enabled = fsbpconfig['fsbankp-disabled'] !== '1';
    console.debug(`${arguments.callee.name}: ${enabled}`);
    return enabled;
}

function content_blocking_enabled() {
    if (fsbpconfig['fsbp-content-block'] && fsbpconfig['fsbp-content-block'].disabled === '1') {
        return false;
    }

    return true;
}

function content_category_states() {
    return fsbpconfig['fsbp-content-block'] ? fsbpconfig['fsbp-content-block']['category-enabled-states'] : {};
}

function blocked_categories() {
    const cats = [];
    const states = content_category_states();
    for (const key in states) {
        if (states[key] === true) {
            cats.push(key);
        }
    }

    return cats;
}

function blocked_category_set(cats) {
    const cats_intersection = [];

    if (content_blocking_enabled()) {
        const blocked_cats = blocked_categories();
        for (const i in blocked_cats) {
            const cat = blocked_cats[i];
            if (cat in cats) {
                if (cats[cat][0] > 80) {
                    cats_intersection.push(cat);
                }
            } else if (cat === 'unknown') {
                if (!cats || (cats.safe && cats.safe[0] === 0)) {
                    cats_intersection.push('unknown');
                }
            }
        }
    }

    return cats_intersection;
}

function is_banking_site(cats) {
    if (!banking_protection_enabled()) {
        return false;
    }

    if (cats.fso_safe && cats.fso_safe[0] >= 80) {
        if (cats.fso_dynamic && cats.fso_dynamic[0] === 100) {
            console.log('Not a banking site');
            return false;
        }

        if (cats.fso_banking && cats.fso_banking[0] >= 80) {
            console.log('This is banking site');
            return true;
        }

        console.log('safe, not dynamic, fso_banking < 80, not banking site');
        return false;
    }

    console.log('not a safe site for banking');
    return false;
}

function is_whitelisted(url) {
    return fsbpconfig.whitelist ? is_whitelisted_in(url, fsbpconfig.whitelist) : false;
}

function is_url_an_attachment_content(url) {
    let is_attached_content = false;
    try {
        const req = new XMLHttpRequest();
        req.open('HEAD', url, false);
        req.send(null);
        const contenttype = req.getResponseHeader('content-type');
        const is_attachment = req.getResponseHeader('content-disposition');
        console.debug('Content type: ', contenttype, 'Content disposition: ', is_attachment);

        if ((contenttype && (contenttype.toLowerCase().indexOf('application') !== -1)) ||
        (is_attachment && (is_attachment.toLowerCase().indexOf('attachment') !== -1))) {
            console.log('content type matched to attached stream');
            is_attached_content = true;
        }
    } catch (error) {
        is_attached_content = false;
        console.error('Exception occurred while loading the url using XMLHttpRequest', error);
    } finally {
        console.log('is_url_an_attachment_content', is_attached_content);
    }

    return is_attached_content;
}

function domain_name_for_the_url(url) {
    let domain;
    const host_name = hostname_for_url(url);
    if (host_name) {
        const parts = host_name.split('.').reverse();
        if (parts && parts.length > 1) {
            domain = parts[1] + '.' + parts[0];
            if (((host_name.toLowerCase().indexOf('.co.uk') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.au') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.tw') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.tr') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.nz') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.vn') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.my') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.hsk') !== -1) ||
            (host_name.toLowerCase().indexOf('.com.br') !== -1) ||
            (host_name.toLowerCase().indexOf('.or.jp') !== -1)) && parts.length > 2) {
                domain = parts[2] + '.' + domain;
            }
        }
    }

    console.debug('Domain name (from local) is ', domain);
    return domain;
}
function ready(fn) {
    if (document.attachEvent ? document.readyState === 'complete' : document.readyState !== 'loading') {
        fn();
    } else {
        document.addEventListener('DOMContentLoaded', fn);
    }
}

function get_language() {
    const locale = window.navigator.language.split('-');
    return locale.length > 1 ? locale[1] : locale[0];
}

function get_popup_bubble() {
    let popup_x_offset = '-32px';
    if (search_engine.bing) {
        popup_x_offset = '-13px';
    }

    return 'background-image:url(' + fs_rating_images.bubble_background + ');width:410px;display: block !important; opacity:0.9; position: absolute; z-index: 50; top: -65px; left: ' + popup_x_offset + ';';
}

let current_popup = null;

function add_rating_actions(bubbleInfo) {
    const rating_image = bubbleInfo.firstChild;
    const bubble = rating_image.nextSibling;

    function hide(popup) {
        if (popup) {
            popup.style = 'display: none; opacity:0;';
        }
    }

    function schedule_hide(popup) {
        popup.hideTimeoutId = setTimeout(() => {
            hide(popup);
        }, 500);
    }

    if (rating_image.className === 'rating-summary-rating-icon fs-bp-status' &&
    bubble.className === 'fsc-bp-popup outer-bubble') {
        bubble.addEventListener('mouseenter', () => {
            if (bubble.hideTimeoutId) {
                clearTimeout(bubble.hideTimeoutId);
            }
        });

        bubble.addEventListener('mouseleave', () => {
            schedule_hide(bubble);
        });

        bubble.addEventListener('click', (event) => {
            console.debug('bubble clicked');
            event.stopPropagation();
            hide(bubble);
        });

        rating_image.addEventListener('mouseleave', () => {
            schedule_hide(bubble);
        });

        rating_image.addEventListener('click', (event) => {
            console.debug('rating image clicked');
            event.stopPropagation();
            hide(current_popup);
            bubble.style = get_popup_bubble();
            current_popup = bubble;
        });
    }
}

function add_blockpage_categories(blocked_categories) {
    if (!fsbpconfig) {
        console.error('cannot fill blocked category names/images to blockpage without fsbpconfig');
        return '';
    }

    let tags = '';
    for (let i = 0; i < blocked_categories.length; i++) {
        const category = fs_category_mappings[blocked_categories[i]];
        if (!category) {
            console.error('category name not found in fs_category_mappings: ', blocked_categories[i]);
        } else {
            tags += '<img src=\'' + category.icon + '\' style=\'vertical-align: middle;\'><span style=\'vertical-align: middle;\'>' + fsbpconfig[category.title] + '</span>';
        }
    }

    if (tags !== '') {
        return '<div><div>' + tags + '</div></div>';
    }

    return '';
}

function add_rating_container_categories(blocked_categories) {
    if (!fsbpconfig) {
        console.error('cannot fill blocked category names/images to rating container without fsbpconfig');
        return '';
    }

    let tags = '';
    for (let i = 0; i < blocked_categories.length; i++) {
        const category = fs_category_mappings[blocked_categories[i]];
        if (!category) {
            console.error('category name not found in fs_category_mappings: ', blocked_categories[i]);
        } else {
            tags += '<img src=\'' + category.icon + '\'><span style=\'font-size:12px;\'>' + fsbpconfig[category.title] + '</span>';
        }
    }

    if (tags !== '') {
        return '<div class=\'category-container\' style=\'margin-top: 17px  !important; margin-left: 36px\'>' +
        '<div class=\'line2\' style=\'display:block;font-size:11px;\'>' +
        tags +
        '</div></div>';
    }

    return '';
}

function create_rating_icon(icon, class_name) {
    const imgalign = search_engine.bing ? 'bottom' : 'left';
    let imgstyle = 'position:relative; top: 50%; height: 16px;';

    if (search_engine.duckduckgo) {
        if (is_safari()) {
            imgstyle += 'top: 1px;';
        } else {
            imgstyle += 'top: 3px;';
        }
    } else if (!is_safari() && (search_engine.bing || search_engine.yahoo)) {
        imgstyle += 'top: 2px;';
    } else if (search_engine.yahoo_jp) {
        imgstyle += 'top: 4px;';
    } else if (search_engine.google) {
        if (is_safari()) {
            imgstyle += 'top: 2px;';
        } else {
            imgstyle += 'top: 3px;';
        }

        if (get_language() === 'jp') {
            imgstyle += '-webkit-transform: translateY(25%);';
        }
    }

    return '<img src="' + icon + '" class="' + class_name + '" align="' + imgalign + '" style="' + imgstyle + '">';
}

function create_rating_bubble(icon, localized_text, category_info) {
    const line_margin_top_offset = category_info !== '' ? '3px' : '10px';
    let line1_style_top_margin = 'margin-top: ' + line_margin_top_offset + '  !important';
    line1_style_top_margin = 'top: ' + line_margin_top_offset + '  !important';

    return '<div class="fsc-bp-popup outer-bubble" style="display: none; opacity:0;">' +
    '<div class="inner-bubble" style="margin-top:0px;">' +
    '<div class="status-container" style="height:32px;zoom:1;display:block;position:absolute;">' +
    '<img class="status-image" src="' + icon + '">' +
    '</div>' +
    '<div class="line-container" style="' + line1_style_top_margin + '; width:345px;">' +
    '<div class="line1" style="width:345px; font-weight: bold;">' +
    localized_text +
    '</div>' +
    '</div>' +
    category_info +
    '</div>';
}

function create_rating_container(icon, localized_text, category_info) {
    return '<span class="bubbleInfo">' +
    create_rating_icon(icon, 'rating-summary-rating-icon fs-bp-status') +
    create_rating_bubble(icon, localized_text, category_info) +
    '</span>';
}

function get_rating_icon(cats, is_whitelisted, is_blocked, fsbpconfig) {
    let icon = fs_rating_images.unknown;
    let localization_key = 'string-unknown';

    if (is_whitelisted) {
        icon = fs_rating_images.blue;
        localization_key = 'string-whitelisted';
    } else if (is_blocked) {
        icon = fs_rating_images.denied;
        localization_key = 'string-denied';
    } else if (cats.safe) {
        if (cats.safe[0] < -79) {
            icon = fs_rating_images.error;
            localization_key = 'string-malicious';
        } else if (cats.safe[0] >= 80) {
            icon = fs_rating_images.ok;
            localization_key = 'string-safe';
        } else if (cats.safe[0] > -20) {

        } else if (cats.safe[0] > -80) {
            icon = fs_rating_images.warning;
            localization_key = 'string-suspicious';
        } else if (cats.error) {
            localization_key = 'string-error';
        } else {
            localization_key = 'string-error';
        }
    }

    return {
        icon,
        localization: fsbpconfig[localization_key],
    };
}

function do_inject_rating_icon(node, cats, is_whitelisted, blocked_cats) {
    const rating = get_rating_icon(cats, is_whitelisted, blocked_cats.length, fsbpconfig);
    const rating_container = create_rating_container(rating.icon, rating.localization, add_rating_container_categories(blocked_cats));

    if (search_engine.google ||
    search_engine.yahoo_jp ||
    search_engine.duckduckgo) {
        // prevent bubble cropping
        node.parentNode.style = 'overflow: visible;';
    }

    node.insertAdjacentHTML('beforebegin', rating_container);
    add_rating_actions(node.previousSibling);
}

function fix_bubble_cropping() {
    function overflow_style(selector, override) {
        override = override || 'overflow: visible';
        document.querySelectorAll(selector).forEach((node) => {
            node.style = override;
        });
    }

    if (search_engine.yahoo) {
        overflow_style('div#sticky-hd', 'z-index: 3');
        overflow_style('div#web');
        overflow_style('div#cols');
        overflow_style('div#results');
        overflow_style('ol.reg.mb-15.searchCenterMiddle');
        overflow_style('div.compTitle');
        overflow_style('ol.reg.searchCenterMiddle');
    } else if (search_engine.yahoo_jp) {
        overflow_style('div.w');
    }
}

function apply_search_results(search_engine) {
    if (search_engine) {
        ready(() => {
            console.log('starting checks for ratings');
            search_engine.operate(update_link);
        });
    }
}

function update_link(nodeList) {
    console.debug(nodeList);

    if (!search_engine.resolve(document.URL)) {
        console.debug('Page is not a search engine, not doing link checks for' + document.URL);
        return;
    }
    if (!fsbpconfig.ctx && fsbpconfig['orsp-status'] !== 'orsp-status-503') {
        console.error('No ORSP context, no point in checking links');
        return;
    }

    console.log('Checking links for', document.URL);

    fix_bubble_cropping();

    nodeList.forEach((node, index) => {
        check_reputation(node, index);
    });
}

function check_reputation(node, index) {
    console.debug(node);
    if (node.previousSibling && node.previousSibling.className === 'bubbleInfo') {
        return; //already injected
    }

    const url = get_href(node);
    if (!url) {
        console.debug('no url for reputation check in', node, 'it is not a search link');
        return;
    }

    node.insertAdjacentHTML('beforebegin', create_rating_icon(fs_rating_images.waiting, 'rating-summary-rating-icon fs-bp-status fs-bp-wait-rotate fs-bp-wait-spinner-' + index));

    console.debug('starting reputation check for', url);
    check_url_for_node(node, url, (cats) => {
        if (!cats || cats.error) {
            console.error('ORSP lookup error');
            return false;
        }

        const spinner = document.querySelector('.fs-bp-wait-spinner-' + index);
        spinner.parentNode.removeChild(spinner);

        inject_rating_icon(node, cats, url);
        return true;
    });
}

function get_href(node) {
    const url = node.getAttribute('href');
    if (!url || url.length < 3) {
        return null;
    }

    return url;
}

function format_blockpage(info, whitelist_url_handler) {
    if (info && document.querySelector('#url')) {
        console.debug('formatting blockpage with', info);
        document.querySelector('#url').textContent = info.url;
        document.querySelector('#fsbpport').textContent = info.fsbpport;
        document.querySelector('#fsbpcookie').textContent = info.fsbpcookie;
        document.querySelector('#ctype').textContent = info.ctype;

        if (info.cats) {
            document.querySelector('#cats').textContent = JSON.stringify(info.cats);
        }

        const categories = document.querySelector('#categories');
        if (categories && info.categories) {
            categories.innerHTML += add_blockpage_categories(info.categories);
        }

        const whitelist_button = document.getElementById('button-two');
        if (whitelist_button) {
            whitelist_button.addEventListener('click', () => {
                console.debug('right button action clicked');
                const action = document.getElementById('rightActionValue').value;
                const blockedURL = document.getElementById('url').firstChild.nodeValue;
                if (action === 'action_id=whitelist' && blockedURL !== '') {
                    const fs_baseURL_re = /([^:]+:\/\/[^/]+).*/;
                    const url = blockedURL.replace(fs_baseURL_re, '$1');
                    const cookie = document.getElementById('fsbpcookie').innerHTML;
                    whitelist_url_handler(url, cookie);
                } else {
                    console.error('rightActionValue or blocked url not found!');
                }
            }, true);
        }
    } else {
        console.error('format_blockpage error');
    }
}
let fsbpconfig = null;

function is_safari() {
    return true;
}

function check_url_for_node(node, url, callback) {
    check_url(url, callback);
}

function inject_rating_icon(node, cats, url) {
    do_inject_rating_icon(node, cats, is_whitelisted(url), blocked_category_set(cats));
}

function check_url(url, callback) {
    const starttime = new Date().getTime();

    if (!callback) {
        console.error('No callback');
        return;
    }

    if (!url) {
        console.error('Skipping ORSP lookup for undefined url');
        callback();
        return;
    }

    if (!fsbpconfig.ctx) {
        console.error('orsp context id not configured');
        callback();
        return;
    }

    url = url.replace(/\/$/, ''); //safari inserts a trailing slash to urls
    url = search_engine.parse_redirection(url) || url;

    if (!url.match(/^https?:/i)) {
        console.debug('ignoring non https protocol', url);
        callback();
        return;
    }

    if (url.match(/^https?:\/\/127\.0\.0\.1:*[0-9]*\//i) || url.match(/^https?:\/\/localhost:*[0-9]*\//i)) {
        console.debug('ignoring Localhost URL', url);
        callback();
        return;
    }

    console.debug('check_url', url);
    const space_re = new RegExp('\\+', 'g');
    const orsp_timeout = 4500;
    var escaped_url = escape(url);
    const orsp_req_url = 'http://127.0.0.1:' + fsbpconfig.orspport + '/query/nrs/' + fsbpconfig.ctx + '?t=' + orsp_timeout + '&u=' + escaped_url.replace(space_re, '%2b');

    json_request(orsp_req_url, {
        timeout: 5000,
        success(data) {
            console.trace(data);
            const cats = data.cats;
            const result = {};
            cats.forEach((value) => {
                const cat_name = value[0];
                result[cat_name] = value.slice(1);
            });
            const elapsed = new Date().getTime() - starttime;
            console.debug('check_url request succeeded for ' + url + ' after ' + elapsed + ' ms');

            callback(result);
        },
        error(error, status) {
            const elapsed = new Date().getTime() - starttime;
            console.error('check_url request failed');
            console.debug('failed for ' + url + ' after ' + elapsed + ' ms', error, status);

            let result;
            if (status === 'timeout') {
                result = {
                    cats: [],
                    warning: 'orsp_connection_timeout',
                    elapsed_ms: elapsed,
                };
            } else if (error) {
                result = {
                    error,
                };
            }

            callback(result);
        },
    });
}

function json_request(url, options) {
    const method = options.type ? options.type : 'GET';
    console.debug('fs-http-proxy request (' + method + ') ' + url);

    message_handler.proxy_request(url, method, options.body, (response) => {
        console.debug('json_request loaded result "' + response + '"');
        let json;
        try {
            json = JSON.parse(response);
        } catch (error) {
            console.error(error);
            options.error();
            return;
        }

        options.success(json);
    });
}

function generate_blockpage(url, cats, category_block) {
    url = search_engine.parse_redirection(url) || url;

    const query = category_block ? '/cb?' : '/b?';
    const id = Math.floor(Math.random() * 100000000);
    const blockpage = {
        url: 'http://127.0.0.1:' + fsbpconfig.bpport + query + id,
        info: {
            url,
            id,
            cats,
            ctime: new Date().getTime(),
            ctype: is_url_an_attachment_content(url),
            blocked_categories: blocked_category_set(cats),
        },
    };

    return blockpage;
}

function get_blockpage_url(id) {
    let url = 'http://127.0.0.1:' + fsbpconfig.bpport + '/blockpage-info';
    if (id !== undefined) {
        url += '?' + id;
    }

    return url;
}

function show_blockpage(blockpage) {
    console.debug('storing blockpage info: ', blockpage);
    const starttime = new Date().getTime();
    let request_body;

    try {
        request_body = JSON.stringify({
            info: blockpage.info,
        });
    } catch (e) {
        console.error('fatal error, can\'t store blockpage info', e);
        return;
    }

    function redirect() {
        // replaces the location of the current window with the new one, removing history
        window.location.replace(blockpage.url);
    }

    const url = get_blockpage_url();
    json_request(url, {
        type: 'POST',
        body: request_body,
        success() {
            const elapsed = new Date().getTime() - starttime;
            console.debug('store_blockpage POST succeeded for ' + url + ' after ' + elapsed + ' ms');

            redirect();
        },
        error(error, status) {
            const elapsed = new Date().getTime() - starttime;
            console.error('store_blockpage request failed!');
            console.debug('fail for ' + url + ' after ' + elapsed + ' ms', error, status);

            redirect(); // redirect even in the case of errors. it looks good even without formatting and info
        },
    });
}

function get_blockpage_info() {
    const starttime = new Date().getTime();
    console.log('getting blockpage info for ID ' + document.URL.split(/\?/)[1]);

    const url = get_blockpage_url(document.URL.split(/\?/)[1]);
    json_request(url, {
        success(blockpage_info) {
            const elapsed = new Date().getTime() - starttime;
            console.debug('get_blockpage_info succeeded for ' + url + ' after ' + elapsed + ' ms');
            console.trace('get_blockpage_info response', blockpage_info);

            finish_blockpage(blockpage_info);
        },
        error(error, status) {
            const elapsed = new Date().getTime() - starttime;
            console.error('get_blockpage_info request failed');
            console.debug('fail for ' + url + ' after ' + elapsed + ' ms', error, status);
        },
    });
}

function finish_blockpage(blockpage_info) {
    ready(() => {
        format_blockpage({
            url: blockpage_info.url,
            fsbpport: fsbpconfig.bpport,
            fsbpcookie: fsbpconfig.cookie,
            ctype: blockpage_info.ctype,
            categories: blockpage_info.blocked_categories,
        }, MessageHandler.whitelist_url);
    });
}

function browsing_protection_enabled() {
    const enabled = fsbpconfig['fsbp-disabled'] !== '1';
    console.debug(`${arguments.callee.name}: ${enabled}`);
    return enabled;
}

function process_page_content() {
    if (browsing_protection_enabled() || content_blocking_enabled()) {
        const engine = search_engine.resolve(document.URL);
        if (!safe_search_redirect(engine)) {
            resolve_blocking(document.URL);
        }

        if (browsing_protection_enabled()) {
            apply_search_results(engine);
        }
    }
}

function valid_subscription() {
    const invalid = !fsbpconfig.ctx || fsbpconfig['orsp-status'] === 'subscription-invalid';
    console.debug(`${arguments.callee.name}: ${!invalid}`);
    return !invalid;
}

function resolve_subscription() {
    // poll here for valid subscription, then continue
    if (valid_subscription()) {
        process_page_content();
    } else {
        setTimeout(() => {
            message_handler.update_configuration(resolve_subscription);
        }, 3000);
    }
}

function safe_search_redirect(engine) {
    if (engine) {
        const url = new URL(document.URL);
        const pathname = url.pathname.substring(1);
        if (engine.search_path_regex && engine.search_path_regex.test(pathname)) {
            if (document.URL.includes(engine.safe_search_query)) {
                console.log('SafeSearch enabled');
            } else if (content_blocking_enabled()) {
                console.log('redirecting with SafeSearch');
                window.location.replace(document.URL + '&' + engine.safe_search_query);
                return true;
            }
        }
    }

    return false;
}

function resolve_blocking(url) {
    if (is_whitelisted(url)) {
        console.debug('allowing whitelisted page ', url);
        return;
    }

    check_url(url, (cats) => {
        if (!cats || cats.error) {
            console.error('ORSP lookup error');
            return;
        }

        let blockpage = null;

        if (is_banking_site(cats)) {
            trigger_banking_notification(url);
        } else if (is_unsafe(cats)) {
            //always go to blockpage for unsafe sites, no matter what
            blockpage = generate_blockpage(url, cats, false);
        } else if (blocked_category_set(cats).length) {
            //this can only happen if content blocking is enabled
            blockpage = generate_blockpage(url, cats, true);
        }

        if (blockpage && blockpage.url) {
            console.log('redirecting to blockpage:');
            console.debug('blocking [' + url + '] redirecting to: ' + blockpage.url);
            show_blockpage(blockpage);
        } else {
            console.log('page is safe or allowed by content blocking');
        }
    });
}

function trigger_banking_notification(url) {
    const domain = domain_name_for_the_url(url);
    console.log('triggering banking notification');
    console.debug('domain ', domain, 'with cookie ', fsbpconfig.cookie);

    if (!domain || !fsbpconfig.cookie) {
        console.error('url or cookie is missing, notification will not work');
        return;
    }

    const request_body = {
        'banking': {
            'bankurl': domain,
            'cookie': fsbpconfig.cookie,
        },
    };

    const banking_trigger_url = 'http://127.0.0.1:' + fsbpconfig.bpport + '/banking';
    json_request(banking_trigger_url, {
        url,
        type: 'POST',
        body: JSON.stringify(request_body),
        success(data) {
            console.debug('submitted current banking notification details', data);
        },
        error(error) {
            console.error('error submitting banking notification details', error);
        },
    });
}

function set_configuration(message) {
    try {
        fsbpconfig = JSON.parse(message.config);
    } catch (e) {
        console.error('fatal error, config missing. unable to run injection further', e);
        return false;
    }

    fsbpconfig.ctx = message.orspContext;
    fsbpconfig.bpport = message.bpPort;
    fsbpconfig.cookie = message.bpCookie;

    // snuff out all logs for performance reasons. comment out the method to enable logs for development
    console_override(MessageHandler.log, [
    'error',
    'info',
    'log',
    'debug',
    'trace',
    'warn',
    ]);

    //this variant forwards to system NSLog through XPC but it is too CPU intensive to enable in production
    //console_override(MessageHandler.logsearch
    console.log('settings and configuration updated');
    console.debug('fsbpconfig: ', fsbpconfig);
    return true;
}

function process_page() {
    const blockpage_regex = /^http:\/\/127\.0\.0\.1:[0-9]+\/[cb]/;

    if (blockpage_regex.test(document.URL)) {
        get_blockpage_info();
    } else {
        resolve_subscription();
    }
}

function inject() {
    console.log('injection entry point. starting message loop with extension sandbox and waiting for settings...');
    message_handler.update_configuration(process_page);
}

const message_handler = new MessageHandler(set_configuration);

inject();
function console_override(log_forward, method_silencers) {
    if (window.console) {
        const methods = [
        'error',
        'info',
        'log',
        'debug',
        'trace',
        'warn',
        ];

        const override = function(method) {
            return function(...args) {
                console_override_internal(log_forward, method, args);
            };
        };

        const silence = function() {};

        if (!method_silencers) {
            method_silencers = [];
        }

        methods.forEach((method) => {//NOTE! comment out the below line to log into browser internal console.
            window.console[method] = method_silencers.includes(method) ? silence : override(method);
        });
    }
}

function console_override_internal(log_forward, log_level, ...args) {
    let log = '';
    Object.values(args[0]).forEach((value) => {
        if (value.constructor === String) {
            log += value;
        } else {
            try {
                log += JSON.stringify(value);
            } catch (e) {
                log += value;
            }
        }

        log += ' ';
    });

    if (log_forward && log !== '') {
        log_forward(log_level, log);
    }
}

